/*
  glsl-simulator.js 0.1.0
  https://www.github.com/burg/glsl-simulator/

  Copyright (c) 2014, Brian Burg <burg@cs.uw.edu>
  Copyright (c) 2014, Xiao Sophia Wang.
  All rights reserved.

  Distributed under the terms of the Simplified BSD License:

  Redistribution and use in source and binary forms, with or without
  modification, are permitted provided that the following conditions are met:

  1. Redistributions of source code must retain the above copyright notice, this
     list of conditions and the following disclaimer.
  2. Redistributions in binary form must reproduce the above copyright notice,
     this list of conditions and the following disclaimer in the documentation
     and/or other materials provided with the distribution.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
  ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
var GLSL=function(){var e={define:function(t,r){function n(t){for(var r=i+t,n=/[^\/]+\/\.\.\/|\.\//;n.test(r);)r=r.replace(n,"");return e[r]}var i=t.replace(/(^|\/)[^/]+$/,"$1"),s={exports:{}};r(s,n),this[t]=s.exports}};return e.define("error",function(e){var t={};t.Error={},t.Error.Type={VertexShaderParsing:"error-type-vertex-shader-parsing",FragmentShaderParsing:"error-type-fragment-shader-parsing",VertexShaderTranslation:"error-type-vertex-shader-translation",FragmentShaderTranslation:"error-type-fragment-shader-translation",VertexShaderExecution:"error-type-vertex-shader-execution",FragmentShaderExecution:"error-type-fragment-shader-execution"},e.exports=t.Error}),e.define("events",function(e){var t={};t.Object=function(){},t.Object.addConstructorFunctions=function(e){for(var r in t.Object){var n=t.Object[r];"function"==typeof n&&n!==arguments.callee&&(e[r]=n)}},t.Object.addEventListener=function(e,t,r){if(r=r||null,console.assert(e,"Object.addEventListener: invalid event type ",e,"(listener: ",t,"thisObject: ",r,")"),e&&(console.assert(t,"Object.addEventListener: invalid listener ",t,"(event type: ",e,"thisObject: ",r,")"),t)){this._listeners||(this._listeners={});var n=this._listeners[e];n||(n=this._listeners[e]=[]);for(var i=0;i<n.length;++i)if(n[i].listener===t&&n[i].thisObject===r)return;n.push({thisObject:r,listener:t})}},t.Object.removeEventListener=function(e,t,r){if(e=e||null,t=t||null,r=r||null,this._listeners)if(e){var n=this._listeners[e];if(n){for(var i=n.length-1;i>=0;--i)t&&n[i].listener===t&&n[i].thisObject===r?n.splice(i,1):!t&&r&&n[i].thisObject===r&&n.splice(i,1);n.length||delete this._listeners[e],Object.keys(this._listeners).length||delete this._listeners}}else for(e in this._listeners)this.removeEventListener(e,t,r)},t.Object.removeAllListeners=function(){delete this._listeners},t.Object.hasEventListeners=function(e){return this._listeners&&this._listeners[e]?!0:!1},t.Object.prototype={constructor:t.Object,addEventListener:t.Object.addEventListener,removeEventListener:t.Object.removeEventListener,removeAllListeners:t.Object.removeAllListeners,hasEventListeners:t.Object.hasEventListeners,dispatchEventToListeners:function(e,r){function n(t){if(t&&t._listeners&&t._listeners[e]&&!i._stoppedPropagation)for(var r=t._listeners[e].slice(0),n=0;n<r.length&&(r[n].listener.call(r[n].thisObject,i),!i._stoppedPropagation);++n);}var i=new t.Event(this,e,r);n(this),i._stoppedPropagation=!1;for(var s=this.constructor;s&&(n(s),s.prototype.__proto__);)s=s.prototype.__proto__.constructor;return i.defaultPrevented}},t.Event=function(e,t,r){this.target=e,this.type=t,this.data=r,this.defaultPrevented=!1,this._stoppedPropagation=!1},t.Event.prototype={constructor:t.Event,stopPropagation:function(){this._stoppedPropagation=!0},preventDefault:function(){this.defaultPrevented=!0}},e.exports=t}),e.define("runtime/vector",function(e){Runtime={},Runtime.vec=function(e){if(!(this instanceof Runtime.vec)){for(var t=[],r=0;r<arguments.length;++r)arguments[r]instanceof Runtime.vec?t=t.concat(arguments[r].get().slice()):"number"==typeof arguments[r]&&t.push(arguments[r]);return new Runtime.vec(t)}return this.d=e,this},Runtime.vec.prototype={constructor:Runtime.vec,cast:function(e){if("undefined"==typeof e||e===this.dimensions()){switch(this.dimensions()){case 2:return new Runtime.Vec2(this.d);case 3:return new Runtime.Vec3(this.d);case 4:return new Runtime.Vec4(this.d)}return this}if(e<this.dimensions())return this.d.splice(e,this.dimensions()-e),this.cast();if(1==this.dimensions()){for(var t=1;e>t;++t)this.d.push(this.d[0]);return this.cast()}return this},get:function(e){if("undefined"==typeof e)return this.d;if("string"==typeof e){for(var t=[],r=0;r<e.length;++r)switch(e.charAt(r)){case"x":case"r":case"s":t.push(this.d[0]);break;case"y":case"g":case"t":this.dimensions()>=2&&t.push(this.d[1]);break;case"z":case"b":case"p":this.dimensions()>=3&&t.push(this.d[2]);break;case"w":case"a":case"q":this.dimensions()>=4&&t.push(this.d[3])}return 1===t.length?t[0]:Runtime.vec.apply(null,t).cast()}return e>=this.dimensions()?null:this.d[e]},set:function(e,t){if("number"==typeof e)return e<this.dimensions()&&(this.d[e]=t),this;if("string"==typeof e){for(var r=0;r<e.length;++r){var n="number"==typeof t?t:t.get(r);switch(e.charAt(r)){case"x":case"r":case"s":this.set(0,n);break;case"y":case"g":case"t":this.dimensions()>=2&&this.set(1,n);break;case"z":case"b":case"p":this.dimensions()>=3&&this.set(2,n);break;case"w":case"a":case"q":this.dimensions()>=4&&this.set(3,n);break;default:throw new Error("Unknown field or index selector character '"+e.charAt(r)+"' for Runtime.vec")}}return this}throw new Error("Unknown field or index selector '"+e+"' for Runtime.vec")},dimensions:function(){return this.d.length},add:function(e){if(e instanceof Runtime.vec)for(var t=0;t<this.d.length;++t)this.d[t]+=e.d[t];else{if("number"!=typeof e)throw new Error("Unexpected argument to vec.add");for(var t=0;t<this.d.length;++t)this.d[t]+=e}return this},negate:function(){for(var e=0;e<this.d.length;++e)this.d[e]=-this.d[e];return this},subtract:function(e){if(e instanceof Runtime.vec)for(var t=0;t<this.d.length;++t)this.d[t]-=e.d[t];else{if("number"!=typeof e)throw new Error("Unexpected argument to vec.subtract");for(var t=0;t<this.d.length;++t)this.d[t]-=e}return this},multiply:function(e){if(e instanceof Runtime.vec){if(!this._op_check(e))return;for(var t=0;t<this.d.length;++t)this.d[t]*=e.d[t];return this}for(var t=0;t<this.d.length;++t)this.d[t]*=e;return this},divide:function(e){if(e instanceof Runtime.vec)for(var t=0;t<this.d.length;++t)this.d[t]/=e.d[t];else{if("number"!=typeof e)throw new Error("Unexpected argument to vec.add");e=e||1e-7;for(var t=0;t<this.d.length;++t)this.d[t]/=e}return this},equal:function(e){if(this._op_check(e)){for(var t=0;t<this.d.length;++t)if(this.d[t]!=e.d[t])return!1;return!0}},dot:function(e){if(this._op_check(e)){for(var t=0,r=0;r<this.d.length;++r)t+=this.d[r]*e.d[r];return t}},normalize:function(){for(var e=this.length(),t=0;t<this.d.length;++t)this.d[t]/=e;return this},length:function(){return Math.sqrt(this.length2())},length2:function(){for(var e=0,t=0;t<this.d.length;++t)e+=this.d[t]*this.d[t];return e},_op_check:function(e){return e instanceof Runtime.vec?e.dimensions()!=this.dimensions()?(console.error("unable to operate on two vecs of different dimensions."),!1):!0:(console.error("argument to vec operation is not a vec."),!1)}},Runtime.Vec2=function(e){return this instanceof Runtime.Vec2?2!=e.length?void console.error("2 arguments to Vec2 is expected."):(this.d=e,this):Runtime.vec.apply(null,arguments).cast(2)},Runtime.Vec2.prototype={constructor:Runtime.Vec2,__proto__:Runtime.vec.prototype},Runtime.Vec3=function(e){return this instanceof Runtime.Vec3?3!=e.length?void console.error("3 arguments to Vec3 is expected."):(this.d=e,this):Runtime.vec.apply(null,arguments).cast(3)},Runtime.Vec3.prototype={constructor:Runtime.Vec3,__proto__:Runtime.vec.prototype},Runtime.Vec3.prototype.cross=function(e){return 3!=e.dimensions()&&console.error("arguments to Vec3.cross() should be Vec3."),Runtime.Vec3(this.get(1)*e.get(2)-this.get(2)*e.get(1),this.get(2)*e.get(0)-this.get(0)*e.get(2),this.get(0)*e.get(1)-this.get(1)*e.get(0))},Runtime.Vec4=function(e){return this instanceof Runtime.Vec4?4!=e.length?void console.error("4 arguments to Vec4 is expected."):(this.d=e,this):Runtime.vec.apply(null,arguments).cast(4)},Runtime.Vec4.prototype={constructor:Runtime.Vec4,__proto__:Runtime.vec.prototype},e.exports={vec:Runtime.vec,Vec2:Runtime.Vec2,Vec3:Runtime.Vec3,Vec4:Runtime.Vec4}}),e.define("runtime/matrix",function(e,t){var r={};r.vec=t("./vector").vec,r.mat=function(e){if(!(this instanceof r.mat)){var t=[];if(arguments[0]instanceof r.mat){for(var n=arguments[0].d.length,i=0;n>i;i++)t.push(arguments[0].d[i].slice());return new r.mat(t)}if(arguments[0]instanceof r.vec){for(var n=arguments.length,i=0;n>i;i++)t.push([]);for(var i=0;n>i;i++)for(var s=0;n>s;s++)t[s].push(s<arguments[i].dimensions()?arguments[i].get(s):0);return new r.mat(t)}for(var n=Math.floor(Math.sqrt(arguments.length)),i=0;n>i;i++)t.push([]);for(var i=0;n>i;i++)for(var s=0;n>s;s++)t[s].push(arguments[i*n+s]);return new r.mat(t)}return this.d=e,this},r.mat.prototype={constructor:r.mat,cast:function(){if(0==arguments.length||arguments[0]==this.dimensions()){switch(this.dimensions()){case 2:return new r.Mat2(this.d);case 3:return new r.Mat3(this.d);case 4:return new r.Mat4(this.d)}return this}var e=arguments[0];if(e<this.dimensions()){this.d.splice(e,this.dimensions()-e);for(var t in this.d)this.d[t].splice(e,this.d[t].length-e);return this.cast()}var n=1==this.dimensions()?this.d[0][0]:1;for(var t in this.d)for(var i=this.dimensions();e>i;i++)this.d[t].push(0);for(var t=this.dimensions();e>t;t++){this.d.push([]);for(var i=0;e>i;i++)this.d[t].push(t==i?n:0)}return this.cast()},get:function(){if(0==arguments.length)return null;var e=arguments[0];if(e>=this.dimensions())return null;var t=r.vec.apply(null,this.d[e]);if(1==arguments.length)return t.cast();var n=arguments[1];return t.get(n)},set:function(){if(arguments.length<2)return this;var e=arguments[0];if(e>=this.dimensions())return this;if(2==arguments.length){for(var t=arguments[1],n=0;n<this.dimensions();n++)this.d[e][n]=n<t.dimensions()?t.get(n):0;return this}var n=arguments[1],i=arguments[2],t=r.vec.apply(null,this.d[e]).set(n,i);return"number"==typeof t?(this.d[e][n]=t,this):(this.d[e]=t.d,this)},dimensions:function(){return this.d.length},equal:function(e){if(!this._op_check(e))return!1;if(this.dimensions()!=e.dimensions())return!1;for(var t=0;t<this.dimensions();t++)for(var r=0;r<this.dimensions();r++)if(this.d[t][r]!=e.d[t][r])return!1;return!0},add:function(e){return this._op(e,"+")},subtract:function(e){return this._op(e,"-")},matrixCompMult:function(e){return this._op(e,"*")},divide:function(e){return this._op(e,"/")},multiply:function(e){if(e instanceof r.mat){if(!this._op_check(e))return this;for(var t=r.mat(e).subtract(e),n=0;n<this.dimensions();n++)for(var i=0;i<this.dimensions();i++)for(var s=0;s<this.dimensions();s++)t.d[i][n]+=this.d[s][n]*e.d[i][s];return t}if(e instanceof r.vec){if(!this._op_check_vec(v))return this;for(var t=r.vec(e).subtract(e),n=0;n<this.dimensions();n++){for(var a=0,i=0;i<this.dimensions();i++)a+=this.d[i][n]*e.get(i);t.set(n,a)}return t}for(var n=0;n<this.dimensions();n++)for(var i=0;i<this.dimensions();i++)this.d[n][i]*=e;return this},_op:function(e,t){if(!this._op_check(e))return this;for(var r=0;r<this.dimensions();r++)for(var n=0;n<this.dimensions();n++)"+"==t?this.d[r][n]+=e.d[r][n]:"-"==t?this.d[r][n]-=e.d[r][n]:"*"==t?this.d[r][n]*=e.d[r][n]:"/"==t&&(this.d[r][n]/=e.d[r][n]);return this},_op_check:function(e){return e instanceof r.mat?e.dimensions()!=this.dimensions()?(console.error("unable to operate on two mats of different dimensions."),!1):!0:(console.error("argument to mat operation is not a mat."),!1)},_op_check_vec:function(e){return e instanceof r.vec?e.dimensions()!=this.dimensions()?(console.error("unable to operate on mat and vec of different dimensions."),!1):!0:(console.error("argument is not a vec."),!1)}},r.Mat2=function(e){return this instanceof r.Mat2?2!=e.length?void console.error("2 arguments to Mat2 is expected."):(this.d=e,this):r.mat.apply(null,arguments).cast(2)},r.Mat2.prototype={constructor:r.Mat2,__proto__:r.mat.prototype},r.Mat3=function(e){return this instanceof r.Mat3?3!=e.length?void console.error("3 dimensions of Mat3 is expected."):(this.d=e,this):r.mat.apply(null,arguments).cast(3)},r.Mat3.prototype={constructor:r.Mat3,__proto__:r.mat.prototype},r.Mat4=function(e){return this instanceof r.Mat4?4!=e.length?void console.error("4 dimensions of Mat4 is expected."):(this.d=e,this):r.mat.apply(null,arguments).cast(4)},r.Mat4.prototype={constructor:r.Mat4,__proto__:r.mat.prototype},e.exports={mat:r.mat,Mat2:r.Mat2,Mat3:r.Mat3,Mat4:r.Mat4}}),e.define("runtime/access",function(e,t){var r={};r.vec=t("./vector").vec,r.mat=t("./matrix").mat;var n={};n.get=function(){if(0!=arguments.length){var e=arguments[0];return e instanceof r.vec?arguments.length<2?e:e.get(arguments[1]):e instanceof r.mat?arguments.length<2?e:2==arguments.length?e.get(arguments[1]):e.get(arguments[1],arguments[2]):e}},n.set=function(){if(0!=arguments.length){var e=arguments[0];return e instanceof r.vec?arguments.length<3?e:e.set(arguments[1],arguments[2]):e instanceof r.mat?arguments.length<3?e:3==arguments.length?e.set(arguments[1],arguments[2]):e.set(arguments[1],arguments[2],arguments[3]):e}},e.exports=n}),e.define("runtime/internal",function(e,t){var n={},i=t("./vector");n.vec=i.vec,n.Vec2=i.Vec2,n.Vec3=i.Vec3,n.Vec4=i.Vec4;var s={};s._evalVec=function(){var e=arguments[arguments.length-1];r=n.vec(arguments[0]).cast();for(var t=0;t<arguments[0].dimensions();t++){for(var i=[],s=0;s<arguments.length-1;s++)i.push(arguments[s].get(t));r.set(t,e.apply(this,i))}return r},s._extVec=function(e,t){if(e instanceof n.vec)return e;switch(t.dimensions()){case 2:return n.Vec2(e);case 3:return n.Vec3(e);case 4:return n.Vec4(e)}return e},s._compare=function(e,t,r){var i=n.vec(e).subtract(e);if("<"==r)for(var s=0;s<e.dimensions();s++)i.set(s,e.get(s)<t.get(s)?1:0);else if("<="==r)for(var s=0;s<e.dimensions();s++)i.set(s,e.get(s)<=t.get(s)?1:0);else if(">"==r)for(var s=0;s<e.dimensions();s++)i.set(s,e.get(s)>t.get(s)?1:0);else if(">="==r)for(var s=0;s<e.dimensions();s++)i.set(s,e.get(s)>=t.get(s)?1:0);else if("=="==r)for(var s=0;s<e.dimensions();s++)i.set(s,e.get(s)==t.get(s)?1:0);else if("!="==r)for(var s=0;s<e.dimensions();s++)i.set(s,e.get(s)!=t.get(s)?1:0);return i},s._op_check=function(){for(var e=0;e<arguments.length;e++){if(!(arguments[e]instanceof n.vec))throw new Error("Expected argument to be instanceof Runtime.vec!");if(e>0&&arguments[e].dimensions()!=arguments[e-1].dimensions())throw new Error("Expected binary operands to have the same dimensions!")}return!0},s._checkNumber=function(){for(var e=0;e<arguments.length;e++)if("number"!=typeof arguments[e])return!1;return!0},s.pos=function(e){return e instanceof n.vec?this._evalVec(e,s.pos):+e},s.neg=function(e){return e instanceof n.vec?this._evalVec(e,s.neg):-e},s.bnot=function(e){return e instanceof n.vec?this._evalVec(e,s.bnot):~e},s.lnot=function(e){return e instanceof n.vec?this._evalVec(e,s.lnot):!e},s.mod=function(e,t){return e instanceof n.vec?this._evalVec(e,this._extVec(t,e),s.mod):e-Math.floor(e/t)*t},s.shl=function(e,t){return e instanceof n.vec?this._evalVec(e,t,s.shl):e<<t},s.shr=function(e,t){return e instanceof n.vec?this._evalVec(e,t,s.shr):e>>t},s.lt=function(e,t){return e instanceof n.vec?this._evalVec(e,t,s.lt):t>e},s.gt=function(e,t){return e instanceof n.vec?this._evalVec(e,t,s.gt):e>t},s.le=function(e,t){return e instanceof n.vec?this._evalVec(e,t,s.le):t>=e},s.ge=function(e,t){return e instanceof n.vec?this._evalVec(e,t,s.ge):e>=t},s.band=function(e,t){return e instanceof n.vec?this._evalVec(e,t,s.band):e&t},s.bxor=function(e,t){return e instanceof n.vec?this._evalVec(e,t,s.bxor):e^t},s.bor=function(e,t){return e instanceof n.vec?this._evalVec(e,t,s.bor):e|t},s.land=function(e,t){return e instanceof n.vec?this._evalVec(e,t,s.land):e&&t},s.lxor=function(e,t){return e instanceof n.vec?this._evalVec(e,t,s.lxor):e&&!t||!e&&t},s.lor=function(e,t){return e instanceof n.vec?this._evalVec(e,t,s.lor):e||t},e.exports=s}),e.define("runtime/builtins",function(e,t){var r={},n=t("./vector"),i=t("./internal"),s=t("./texture");r.vec=n.vec,r.Vec2=n.Vec2,r.Vec3=n.Vec3,r.Vec4=n.Vec4;var a={};a.radians=function(e){return e instanceof r.vec?i._evalVec(e,a.radians):e/180*Math.PI},a.degrees=function(e){return e instanceof r.vec?i._evalVec(e,a.degrees):e/Math.PI*180},a.sin=function(e){return e instanceof r.vec?i._evalVec(e,a.sin):Math.sin(e)},a.cos=function(e){return e instanceof r.vec?i._evalVec(e,a.cos):Math.cos(e)},a.tan=function(e){return e instanceof r.vec?i._evalVec(e,a.tan):Math.tan(e)},a.asin=function(e){return e instanceof r.vec?i._evalVec(e,a.asin):Math.asin(e)},a.acos=function(e){return e instanceof r.vec?i._evalVec(e,a.acos):Math.acos(e)},a.atan=function(e,t){return"undefined"!=typeof t?e instanceof r.vec?i._evalVec(e,t,a.atan):Math.atan2(e,t):e instanceof r.vec?i._evalVec(e,a.atan):Math.atan(e)},a.pow=function(e,t){return e instanceof r.vec?i._evalVec(e,t,a.pow):Math.pow(e,t)},a.exp=function(e){return e instanceof r.vec?i._evalVec(e,a.exp):Math.exp(e)},a.log=function(e){return e instanceof r.vec?i._evalVec(e,a.log):Math.log(e)},a.exp2=function(e){return e instanceof r.vec?i._evalVec(e,a.exp2):Math.pow(2,e)},a.log2=function(e){return e instanceof r.vec?i._evalVec(e,a.log2):Math.log(e)/Math.log(2)},a.sqrt=function(e){return e instanceof r.vec?i._evalVec(e,a.sqrt):Math.sqrt(e)},a.inversesqrt=function(e){return e instanceof r.vec?i._evalVec(e,a.inversesqrt):1/Math.sqrt(e)},a.abs=function(e){return e instanceof r.vec?i._evalVec(e,a.abs):e>=0?e:-e},a.sign=function(e){return e instanceof r.vec?i._evalVec(e,a.sign):0==e?0:e>0?1:-1},a.floor=function(e){return e instanceof r.vec?i._evalVec(e,a.floor):Math.floor(e)},a.ceil=function(e){return e instanceof r.vec?i._evalVec(e,a.ceil):Math.ceil(e)},a.fract=function(e){return e instanceof r.vec?i._evalVec(e,a.fract):e-a.floor(e)},a.mod=function(e,t){return e instanceof r.vec?i._evalVec(e,i._extVec(t,e),a.mod):e-Math.floor(e/t)*t},a.min=function(e,t){return e instanceof r.vec?i._evalVec(e,i._extVec(t,e),a.min):Math.min(e,t)},a.max=function(e,t){return e instanceof r.vec?i._evalVec(e,i._extVec(t,e),a.max):Math.max(e,t)},a.clamp=function(e,t,n){if(t>n)throw new Error("clamp(): maxVal must be larger than minVal.");return e instanceof r.vec?i._evalVec(e,i._extVec(t,e),i._extVec(n,e),a.clamp):a.min(a.max(e,t),n)},a.mix=function(e,t,n){return e instanceof r.vec?i._evalVec(e,t,i._extVec(n,e),a.mix):n*e+(1-n)*t},a.step=function(e,t){return t instanceof r.vec?i._evalVec(i._extVec(e,t),t,a.step):e>t?0:1},a.smoothstep=function(e,t,n){if(n instanceof r.vec)return i._evalVec(i._extVec(e,n),i._extVec(t,n),n,a.smoothstep);var s=a.clamp((n-e)/(t-e),0,1);return s*s*(3-2*s)},a.length=function(e){return i._checkNumber(e)?Math.abs(e):i._op_check(e)?e.length():null},a.distance=function(e,t){if(i._checkNumber(e,t))return Math.abs(e-t);if(!i._op_check(e,t))return null;var n=r.vec(e).subtract(t);return a.length(n)},a.dot=function(e,t){return i._checkNumber(e,t)?e*t:i._op_check(e,t)?e.dot(t):null},a.cross=function(e,t){if(3!=e.dimensions())throw new Error("cross(): parameters x and y must have 3 dimensions.");return i._op_check(e,t)?r.Vec3(e).cross(t):null},a.normalize=function(e){return i._checkNumber(e)?0==e?e:e/Math.abs(e):i._op_check(e)?e.normalize():null},a.faceforward=function(e,t,n){if(!i._op_check(t,e,n))return null;var s=a.dot(n,t)<0?r.vec(e):r.vec(e).negate();return s.cast()},a.reflect=function(e,t){if(!i._op_check(e,t))return null;var n=2*a.dot(e,t);return r.vec(e).subtract(r.vec(t).multiply(n)).cast()},a.refract=function(e,t,n){if(!i._op_check(e,t))return null;var s=1-n*n*(1-a.dot(e,t)*a.dot(e,t));if(0>s)return r.vec(e).subtract(e);var o=n*a.dot(e,t)+Math.sqrt(s);return r.vec(e).multiply(n).subtract(r.vec(t).multiply(o)).cast()},a.matrixCompMult=function(e,t){return e.matrixCompMult(t)},a.lessThan=function(e,t){return i._compare(e,t,"<")},a.lessThanEqual=function(e,t){return i._compare(e,t,"<=")},a.greaterThan=function(e,t){return i._compare(e,t,">")},a.greaterThanEqual=function(e,t){return i._compare(e,t,">=")},a.equal=function(e,t){return i._compare(e,t,"==")},a.notEqual=function(e,t){return i._compare(e,t,"!=")},a.any=function(e){for(var t=0;t<e.dimensions();t++)if(e.get(t))return!0;return!1},a.all=function(e){for(var t=0;t<e.dimensions();t++)if(!e.get(t))return!1;return!0},a.not=function(e){for(var t=r.vec(e),n=0;n<e.dimensions();n++)t.set(n,e.get(n)?0:1);return t},a.texture2DLod=function(e,t,r){return s.texture2D(e,t,r)},a.texture2DProjLod=function(e,t,r){return s.texture2DProj(e,t,r)},a.textureCubeLod=function(e,t,r){return s.textureCube(e,t,r)},a.texture2D=function(e,t){return 3==arguments.length?s.texture2D(e,t,arguments[2]):s.texture2D(e,t)},a.texture2DProj=function(e,t){return 3==arguments.length?s.texture2DProj(e,t,arguments[2]):s.texture2DProj(e,t)},a.textureCube=function(e,t){return 3==arguments.length?s.textureCube(e,t,arguments[2]):s.textureCube(e,t)},e.exports=a}),e.define("runtime/ops",function(e,t){var r={};r.vec=t("./vector").vec,r.mat=t("./matrix").mat,n=t("./builtins");var n=t("./internal");Operations={},Operations.op_pos=function(e){return n.pos(e)},Operations.op_neg=function(e){return n.neg(e)},Operations.op_bnot=function(e){return n.bnot(e)},Operations.op_lnot=function(e){return n.lnot(e)},Operations.op_eq=function(e,t){return e instanceof r.vec&&t instanceof r.vec?e.equal(t):e instanceof r.mat&&t instanceof r.mat?e.equal(t):"Object"!=typeof e&&"Object"!=typeof rjs?e==t:!1},Operations.op_neq=function(e,t){return!this.op_eq(e,t)},Operations.op_mul=function(e,t){var n=!(e instanceof r.vec||e instanceof r.mat),i=!(t instanceof r.vec||t instanceof r.mat);return n&&i?e*t:n?t.multiply(e):e.multiply(i?t:t)},Operations.op_div=function(e,t){if(e instanceof r.vec&&t instanceof r.mat)throw new Error("op_div cannot handle vec / mat");if(e instanceof r.mat&&t instanceof r.vec)throw new Error("op_div cannot handle mat / vec");return e instanceof r.vec||e instanceof r.mat?e.divide(t):t instanceof r.vec||t instanceof r.mat?t.divide(e):e/t},Operations.op_mod=function(e,t){return n.mod(e,t)},Operations.op_add=function(e,t){if(e instanceof r.vec&&t instanceof r.mat)throw new Error("op_add cannot handle vec + mat");if(e instanceof r.mat&&t instanceof r.vec)throw new Error("op_add cannot handle mat + vec");return e instanceof r.vec||e instanceof r.mat?e.add(t):t instanceof r.vec||t instanceof r.mat?t.add(e):e+t},Operations.op_sub=function(e,t){if(e instanceof r.vec&&t instanceof r.mat)throw new Error("op_sub cannot handle vec - mat");if(e instanceof r.mat&&t instanceof r.vec)throw new Error("op_sub cannot handle mat - vec");return e instanceof r.vec||e instanceof r.mat?e.subtract(t):t instanceof r.vec||t instanceof r.mat?t.subtract(e):e-t},Operations.op_shl=function(e,t){return n.shl(e,t)},Operations.op_shr=function(e,t){return n.shr(e,t)},Operations.op_lt=function(e,t){return n.lt(e,t)},Operations.op_gt=function(e,t){return n.gt(e,t)},Operations.op_le=function(e,t){return n.le(e,t)},Operations.op_ge=function(e,t){return n.ge(e,t)},Operations.op_band=function(e,t){return n.band(e,t)},Operations.op_bxor=function(e,t){return n.bxor(e,t)},Operations.op_bor=function(e,t){return n.bor(e,t)},Operations.op_land=function(e,t){return n.land(e,t)},Operations.op_lxor=function(e,t){return n.lxor(e,t)},Operations.op_lor=function(e,t){return n.lor(e,t)},e.exports=Operations}),e.define("runtime/environment",function(e,t){GLSL={},GLSL.Object=t("../events").Object,GLSL.Environment=function(){GLSL.Object.call(this),this._data={},this._debugHooks=[],this._editScopeLevel=0,this._runScopeLevel=0},GLSL.Environment.Event={InputChanged:"environment-input-changed",ResultChanged:"environment-result-changed"},GLSL.Environment.prototype={constructor:GLSL.Environment,__proto__:GLSL.Object.prototype,get:function(e){return this._data[e]},set:function(e,t){if(console.assert(this._editScopeLevel||this._runScopeLevel,this),!this._editScopeLevel&&!this._runScopeLevel)throw new Error("Tried to set variable "+e+" while not in a edit or run scope!");this._data[e]=t},clone:function(){var e=new GLSL.Environment;e.enterEditScope();for(var t in this._data)e.set(t,this.get(t));return e.exitEditScope(),e},reset:function(){this._data={}},enterEditScope:function(){console.assert(!this._runScopeLevel,this._runScopeLevel),++this._editScopeLevel},exitEditScope:function(){console.assert(this._editScopeLevel>0,this._editScopeLevel),--this._editScopeLevel,this._editScopeLevel||this.dispatchEventToListeners(GLSL.Environment.Event.InputChanged)},enterRunScope:function(){console.assert(!this._editScopeLevel,this._editScopeLevel),++this._runScopeLevel},exitRunScope:function(){console.assert(!this._editScopeLevel,this._editScopeLevel),console.assert(this._runScopeLevel>0,this._runScopeLevel),--this._runScopeLevel,this._runScopeLevel||this.dispatchEventToListeners(GLSL.Environment.Event.ResultChanged)},get debugHooks(){return this._debugHooks.slice()},clearDebugHooks:function(){this._debugHooks=[]},addDebugHook:function(){},validateForShader:function(){return!0},setDefaultValuesForShader:function(e,t){function r(e,r){var n=null;if(t instanceof Function&&(n=t(r)),!n)switch(r.type){case"float":n=1;break;case"bool":n=!0;break;case"vec2":n=GLSL.Runtime.Vec2(1,1);break;case"vec3":n=GLSL.Runtime.Vec3(1,1,1);break;case"vec4":n=GLSL.Runtime.Vec4(1,1,1,1);break;case"mat2":n=GLSL.Runtime.Mat2(1,1,1,1);break;case"mat3":n=GLSL.Runtime.Mat3(1,1,1,1,1,1,1,1,1);break;case"mat4":n=GLSL.Runtime.Mat4(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)}e.set(r.name,n)}e&&(console.assert(e instanceof GLSL.Shader,e),this.enterEditScope(),e.uniforms.map(r.bind(null,env)),e.attributes.map(r.bind(null,env)),e.type===GLSL.Shader.Type.Fragment&&e.varyings.map(r.bind(null,env)),this.exitEditScope())}},e.exports=GLSL.Environment}),e.define("runtime",function(e,t){var r={},n=t("./runtime/vector");r.vec=n.vec,r.Vec2=n.Vec2,r.Vec3=n.Vec3,r.Vec4=n.Vec4;var i=t("./runtime/matrix");r.mat=i.mat,r.Mat2=i.Mat2,r.Mat3=i.Mat3,r.Mat4=i.Mat4;var s=t("./runtime/builtins"),a=t("./runtime/ops"),o=t("./runtime/access"),c=t("./runtime/texture");for(var u in a)r[u]=a[u];for(var u in s)r[u]=s[u];for(var u in o)r[u]=o[u];for(var u in c)r[u]=c[u];e.exports=r}),e.define("compiler/ast",function(e){ASTNode=function(e,t,r){this.type=e,this.position=t;for(var n in r)r.hasOwnProperty(n)&&(this[n]=r[n])},ASTNode.__nextId=1,ASTNode.Types={Program:"root",Preprocessor:"preprocessor",MacroCall:"macro_call",FunctionCall:"function_call",FunctionPrototype:"function_prototype",FunctionDeclaration:"function_declaration",Scope:"scope",IfStatement:"if_statement",ForStatement:"for_statement",WhileStatement:"while_statement",DoStatement:"do_statement",ReturnStatement:"return",ContinueStatement:"continue",BreakStatement:"break",DiscardStatement:"discard",ExpressionStatement:"expression",Declarator:"declarator",DeclaratorItem:"declarator_item",Invariant:"invariant",Precision:"precision",Parameter:"parameter",StructDefinition:"struct_definition",Type:"type",IntegerLiteral:"int",FloatLiteral:"float",BooleanLiteral:"bool",Identifier:"identifier",Operator:"operator",PostfixExpression:"postfix",UnaryExpression:"unary",BinaryExpression:"binary",TernaryExpression:"ternary",IndexSelector:"accessor",FieldSelector:"field_selector"},e.exports=ASTNode}),e.define("compiler/visitor",function(e){ASTVisitor=function(e){this._callbacks=e||{};for(key in this._callbacks)console.assert("undefined"!==key,"Visitor callback provided for node type 'undefined'. This is a bug. Function text: "+this._callbacks[key].toString())},ASTVisitor.prototype={constructor:ASTVisitor,visitorForType:function(e){return e in this._callbacks?this._callbacks[e]:this.defaultVisitor},visitNode:function(e){if(e&&e.type){var t=this.visitorForType(e.type);return t.call(this,e)}},visitList:function(e){if(e instanceof Array&&e.length){for(var t=[],r=0;r<e.length;++r)t.push(this.visitNode(e[r]));return t}},defaultVisitor:function(e){for(var t in e){var r=e[t];r instanceof Array?this.visitList(r):r instanceof Object&&r.type&&this.visitNode(r)}}},e.exports=ASTVisitor}),e.define("compiler/typecheck",function(e){var t={};t.Typechecker=function(){},t.Typechecker.prototype={constructor:t.Typechecker,typecheck:function(){return!0}},e.exports=t.Typechecker}),e.define("compiler/pretty",function(e,t){var r=t("./visitor");PrettyPrinter=function(){r.call(this),this._scopes=[],this._currentIndent=""},PrettyPrinter.prototype={constructor:PrettyPrinter,__proto__:r.prototype,formattedText:function(e){return this._lines=[],this.visitNode(e),this._lines.join("\n")},visitorForType:function(e){return e in PrettyPrinter.Callbacks?PrettyPrinter.Callbacks[e]:r.prototype.visitorForType(e)},_addLine:function(e){this._lines.push([this._currentIndent,e].join(""))},_increaseIndent:function(){var e=this._currentIndent;return this._currentIndent=[this._currentIndent,PrettyPrinter.IndentString].join(""),e}},PrettyPrinter.IndentString="    ",PrettyPrinter.Callbacks={},PrettyPrinter.Callbacks[ASTNode.Types.Identifier]=function(e){return e.name},PrettyPrinter.Callbacks[ASTNode.Types.Program]=function(e){this.visitList(e.statements)},PrettyPrinter.Callbacks[ASTNode.Types.Preprocessor]=function(e){if("#define"===e.directive){var t=[e.directive," ",e.identifier];e.parameters&&t.push("("+e.parameters.join(", ")+")"),e.token_string&&(t.push(" "),t.push(e.token_string)),this._addLine(t.join(""))}else{var r="#elif"===e.directive||"#else"===e.directive;r&&"#endif"===this._lines[this._lines.length-1]&&this._lines.pop(),this._addLine(e.directive+" "+e.value),this.visitList(e.guarded_statements),this._addLine("#endif")}},PrettyPrinter.Callbacks[ASTNode.Types.MacroCall]=function(e){return e.macro_name+"("+e.paremeters.join(", ")+")"},PrettyPrinter.Callbacks[ASTNode.Types.FunctionCall]=function(e){var t=this.visitList(e.parameters)||[];return e.function_name+"("+t.join(", ")+")"},PrettyPrinter.Callbacks[ASTNode.Types.FunctionDeclaration]=function(e){var t=this.visitNode(e.returnType),r=this.visitList(e.parameters)||["void"];this._addLine(""),this._addLine(t+" "+e.name+"("+r.join(", ")+") {");var n=this._increaseIndent();this.visitNode(e.body),this._currentIndent=n,this._addLine("}")},PrettyPrinter.Callbacks[ASTNode.Types.FunctionPrototype]=function(e){var t=this.visitNode(e.returnType),r=this.visitList(e.parameters)||["void"];this._addLine(""),this._addLine(t+" "+e.name+"("+r.join(", ")+");")},PrettyPrinter.Callbacks[ASTNode.Types.Scope]=function(e){this._scopes.push(e),this.visitList(e.statements),this._scopes.pop(e)},PrettyPrinter.Callbacks[ASTNode.Types.IfStatement]=function(e){this._addLine("if ("+this.visitNode(e.condition)+") {");var t=this._increaseIndent();if(this.visitNode(e.body),this._currentIndent=t,e.elseBody){this._addLine("} else {");var t=this._increaseIndent();this.visitNode(e.elseBody),this._currentIndent=t}this._addLine("}")},PrettyPrinter.Callbacks[ASTNode.Types.ForStatement]=function(e){var t="";e.initializer&&(this.visitNode(e.initializer),t=this._lines.pop().trim(),t=t.substr(0,t.length-1));var r=this.visitNode(e.condition)||"",n=this.visitNode(e.increment)||"";this._addLine("for ("+[t,r,n].join("; ")+") {");var i=this._increaseIndent();this.visitNode(e.body),this._currentIndent=i,this._addLine("}")},PrettyPrinter.Callbacks[ASTNode.Types.WhileStatement]=function(e){this._addLine("while ("+this.visitNode(e.condition)+") {");var t=this._increaseIndent();this.visitNode(e.body),this._currentIndent=t,this._addLine("}")},PrettyPrinter.Callbacks[ASTNode.Types.DoStatement]=function(e){this._addLine("do {");var t=this._increaseIndent();this.visitNode(e.body),this._currentIndent=t,this._addLine("} while ("+this.visitNode(e.condition)+");")},PrettyPrinter.Callbacks[ASTNode.Types.ReturnStatement]=function(e){this._addLine(e.value?"return "+this.visitNode(e.value)+";":"return;")},PrettyPrinter.Callbacks[ASTNode.Types.ContinueStatement]=function(){this._addLine("continue;")},PrettyPrinter.Callbacks[ASTNode.Types.BreakStatement]=function(){this._addLine("break;")},PrettyPrinter.Callbacks[ASTNode.Types.DiscardStatement]=function(){this._addLine("discard;")},PrettyPrinter.Callbacks[ASTNode.Types.ExpressionStatement]=function(e){this._addLine(this.visitNode(e.expression)+";")},PrettyPrinter.Callbacks[ASTNode.Types.Declarator]=function(e){var t=this.visitNode(e.typeAttribute),r=this.visitList(e.declarators);this._addLine(t+" "+r.join(", ")+";")},PrettyPrinter.Callbacks[ASTNode.Types.DeclaratorItem]=function(e){var t=[this.visitNode(e.name)];return e.initializer&&(t.push("="),t.push(this.visitNode(e.initializer))),t.join(" ")
},PrettyPrinter.Callbacks[ASTNode.Types.Invariant]=function(e){this._addLine("invariant "+this.visitList(e.identifiers).join(", ")+";")},PrettyPrinter.Callbacks[ASTNode.Types.Precision]=function(e){return this._addLine(["precision",e.precision,e.typeName].join(" ")+";")},PrettyPrinter.Callbacks[ASTNode.Types.Parameter]=function(e){var t=[e.type_name,e.name];e.precision&&t.unshift(e.precision),e.parameterQualifier&&t.unshift(e.parameterQualifier),e.typeQualifier&&t.unshift(e.typeQualifier);var r=t.join(" ");return e.arraySize&&(r=r+"["+this.visit(e.arraySize)+"]"),r},PrettyPrinter.Callbacks[ASTNode.Types.StructDefinition]=function(e){var t=["struct"];e.qualifier&&t.unshift(e.qualifier),e.name&&t.push(e.name),t.push("{"),this._addLine(t.join(" "));var r=this._increaseIndent();if(this.visitList(e.members),this._currentIndent=r,!e.declarators)return void this._addLine("};");var n=this.visitList(e.declarators);this._addLine("} "+n.join(", ")+";")},PrettyPrinter.Callbacks[ASTNode.Types.Type]=function(e){var t=[e.name];return e.precision&&t.unshift(e.precision),e.qualifier&&t.unshift(e.qualifier),t.join(" ")},PrettyPrinter.Callbacks[ASTNode.Types.IntegerLiteral]=function(e){return e.value},PrettyPrinter.Callbacks[ASTNode.Types.FloatLiteral]=function(e){return e.value},PrettyPrinter.Callbacks[ASTNode.Types.BooleanLiteral]=function(e){return e.value},PrettyPrinter.Callbacks[ASTNode.Types.Operator]=function(e){return e.operator},PrettyPrinter.Callbacks[ASTNode.Types.PostfixExpression]=function(e){return this.visitNode(e.expression)+this.visitNode(e.operator)},PrettyPrinter.Callbacks[ASTNode.Types.UnaryExpression]=function(e){return this.visitNode(e.operator)+this.visitNode(e.expression)},PrettyPrinter.Callbacks[ASTNode.Types.BinaryExpression]=function(e){var t=[this.visitNode(e.left),this.visitNode(e.operator),this.visitNode(e.right)].join(" "),r=e.operator.operator;return-1===r.indexOf("==")&&-1!==r.indexOf("=")?t:"("+t+")"},PrettyPrinter.Callbacks[ASTNode.Types.TernaryExpression]=function(e){return[this.visitNode(e.condition),"?",this.visitNode(e.is_true),":",this.visitNode(e.is_false)].join(" ")},PrettyPrinter.Callbacks[ASTNode.Types.IndexSelector]=function(e){return"["+this.visitNode(e.index)+"]"},PrettyPrinter.Callbacks[ASTNode.Types.FieldSelector]=function(e){return"."+e.selection},e.exports=PrettyPrinter}),e.define("compiler/codegen",function(e,t){var r=t("./visitor"),n=t("../runtime/builtins"),i=t("../runtime/ops"),s=function(e){r.call(this),this._shader=e,this._currentIndent="",this._withinFunctionScope=null,this._globalVariableNames=new Set;for(var t=e.uniforms,n=0;n<t.length;++n)this._globalVariableNames.add(t[n].name);for(var t=e.varyings,n=0;n<t.length;++n)this._globalVariableNames.add(t[n].name);for(var t=e.attributes,n=0;n<t.length;++n)this._globalVariableNames.add(t[n].name)};s.ConstructorMap={vec2:"Vec2",vec3:"Vec3",vec4:"Vec4",mat2:"Mat2",mat3:"Mat3",mat4:"Mat4"},s.prototype={constructor:s,__proto__:r.prototype,translateShader:function(){this._lines=[],this._addLine(""),this._addLine("var RT = GLSL.Runtime;"),this._addLine(""),this.visitNode(this._shader.ast),this._addLine(""),this._shader.shouldEmitDebuggerStatement&&this._addLine("debugger;"),this._addLine(this._resolveFunction("main")+"();"),this._addLine("");var e={};try{e.code=new Function("GLSL","env",this._lines.join("\n"))}catch(t){e.source="function(GLSL, env) {\n"+this._lines.join("\n")+"}",e.error=t.message}return e},visitorForType:function(e){return e in s.Callbacks?s.Callbacks[e]:r.prototype.visitorForType.call(this,e)},_resolveGetLocal:function(e){return console.assert("string"==typeof e,e),this._resolveGetName(e)},_resolveFunction:function(e){return console.assert("string"==typeof e,e),e in n?"RT."+e:e in i?"RT."+e:e in s.ConstructorMap?"RT."+s.ConstructorMap[e]:this._resolveGetName(e)},_resolveGetName:function(e){return console.assert("string"==typeof e,e),this._globalVariableNames.has(e)?"env.get('"+e+"')":"$"+e},_resolveSetName:function(e,t){return console.assert("string"==typeof e,e),this._globalVariableNames.has(e)?"env.set('"+e+"', "+t+")":"$"+e+" = "+t},_addLine:function(e){this._lines.push([this._currentIndent,e].join(""))},_increaseIndent:function(){var e=this._currentIndent;return this._currentIndent=[this._currentIndent,s.IndentString].join(""),e}},s.IndentString="    ",s.Callbacks={},s.Callbacks[ASTNode.Types.Program]=function(e){this.visitList(e.statements)},s.Callbacks[ASTNode.Types.Preprocessor]=function(){},s.Callbacks[ASTNode.Types.MacroCall]=function(){},s.Callbacks[ASTNode.Types.FunctionCall]=function(e){var t=this.visitList(e.parameters)||[];return this._resolveFunction(e.function_name)+"("+t.join(", ")+")"},s.Callbacks[ASTNode.Types.FunctionPrototype]=function(){},s.Callbacks[ASTNode.Types.FunctionDeclaration]=function(e){var t=this.visitList(e.parameters)||[];t=t.map(function(e){return this._resolveGetLocal(e)},this),this._withinFunctionScope=e,this._addLine("var "+this._resolveGetLocal(e.name)+" = function("+t.join(", ")+") {");var r=this._increaseIndent();this.visitNode(e.body),this._currentIndent=r,this._addLine("};"),delete this._withinFunctionScope},s.Callbacks[ASTNode.Types.Scope]=function(e){this.visitList(e.statements)},s.Callbacks[ASTNode.Types.IfStatement]=function(e){var t=this.visitNode(e.condition);this._addLine("if ("+t+") {");var r=this._increaseIndent();if(this.visitNode(e.body),this._currentIndent=r,e.elseBody){this._addLine("} else {");var r=this._increaseIndent();this.visitNode(e.elseBody),this._currentIndent=r}this._addLine("}")},s.Callbacks[ASTNode.Types.ForStatement]=function(e){this.visitNode(e.initializer);var t=this.visitNode(e.condition)||"true",r=this.visitNode(e.increment);this._addLine("while ("+t+") {");var n=this._increaseIndent();this.visitNode(e.body),r&&this._addLine(r+";"),this._currentIndent=n,this._addLine("}")},s.Callbacks[ASTNode.Types.WhileStatement]=function(e){var t=this.visitNode(e.condition);this._addLine("while ("+t+") {");var r=this._increaseIndent();this.visitNode(e.body),this._currentIndent=r,this._addLine("}")},s.Callbacks[ASTNode.Types.DoStatement]=function(e){var t=this.visitNode(e.condition);this._addLine("do {");var r=this._increaseIndent();this.visitNode(e.body),this._currentIndent=r,this._addLine("} while ("+t+");")},s.Callbacks[ASTNode.Types.ReturnStatement]=function(e){this._addLine(e.value?"return "+this.visitNode(e.value)+";":"return;")},s.Callbacks[ASTNode.Types.ContinueStatement]=function(){this._addLine("continue;")},s.Callbacks[ASTNode.Types.BreakStatement]=function(){this._addLine("break;")},s.Callbacks[ASTNode.Types.DiscardStatement]=function(){this._addLine("discard;")},s.Callbacks[ASTNode.Types.ExpressionStatement]=function(e){this._addLine(this.visitNode(e.expression)+";")},s.Callbacks[ASTNode.Types.Declarator]=function(e){this._withinFunctionScope&&this.visitList(e.declarators)},s.Callbacks[ASTNode.Types.DeclaratorItem]=function(e){var t=this.visitNode(e.name);this._addLine(e.initializer?"var "+t+" = "+this.visitNode(e.initializer)+";":"var "+t+";")},s.Callbacks[ASTNode.Types.Invariant]=function(){},s.Callbacks[ASTNode.Types.Precision]=function(){},s.Callbacks[ASTNode.Types.Parameter]=function(e){return e.name},s.Callbacks[ASTNode.Types.StructDefinition]=function(){},s.Callbacks[ASTNode.Types.Type]=function(){},s.Callbacks[ASTNode.Types.IntegerLiteral]=function(e){return Number(e.value)},s.Callbacks[ASTNode.Types.FloatLiteral]=function(e){return Number(e.value)},s.Callbacks[ASTNode.Types.BooleanLiteral]=function(e){return e.value?"true":"false"},s.Callbacks[ASTNode.Types.Identifier]=function(e){return this._resolveGetName(e.name)},s.Callbacks[ASTNode.Types.Operator]=function(e){return e.operator},s.Callbacks[ASTNode.Types.PostfixExpression]=function(e){var t=this.visitNode(e.operator),r=this.visitNode(e.expression),n=new SelectorBuilder(e),i=n.params.slice(),s=null;switch(t){case"++":s="op_add";break;case"--":s="op_sub";break;default:return i.unshift(this._resolveGetName(n.operand)),"RT.get("+i.join(", ")+")"}var a=s?this._resolveFunction(s)+"("+r+", 1.0)":"/* "+t+" */"+r,i=n.params.slice();return i.unshift(this._resolveGetLocal(n.operand)),i.push(a),n.params.length?this._resolveSetName(n.operand,"RT.set("+i.join(", ")+")"):this._resolveSetName(n.operand,a)},s.Callbacks[ASTNode.Types.UnaryExpression]=function(e){var t=this.visitNode(e.operator),r=this.visitNode(e.expression),n=null;switch(t){case"+":n="op_pos";break;case"-":n="op_neg";break;case"~":n="op_bnot";break;case"!":n="op_lnot";break;default:return"/* "+t+" */"+r}return n?this._resolveFunction(n)+"("+r+")":"/* "+t+" */"+r},s.Callbacks[ASTNode.Types.BinaryExpression]=function(e){var t=this.visitNode(e.operator),r=this.visitNode(e.left),n=this.visitNode(e.right),i=null,s=!1;switch(t){case"==":i="op_eq";break;case"!=":i="op_neq";break;case"*":i="op_mul";break;case"/":i="op_div";break;case"%":i="op_mod";break;case"+":i="op_add";break;case"-":i="op_sub";break;case"<<":i="op_shl";break;case">>":i="op_shr";break;case"<":i="op_lt";break;case">":i="op_gt";break;case"<=":i="op_le";break;case">=":i="op_ge";break;case"&":i="op_band";break;case"^":i="op_bxor";break;case"|":i="op_bor";break;case"&&":i="op_land";break;case"^^":i="op_lxor";break;case"||":i="op_lor";break;case"=":s=!0;break;case"+=":i="op_add",s=!0;break;case"-=":i="op_sub",s=!0;break;case"*=":i="op_mul",s=!0;break;case"/=":i="op_div",s=!0;break;case"%=":i="op_mod",s=!0;break;case"<<=":i="op_shl",s=!0;break;case">>=":i="op_shr",s=!0;break;case"&=":i="op_band",s=!0;break;case"^=":i="op_bxor",s=!0;break;case"|=":i="op_bor",s=!0;break;default:return r+" /* "+t+" */ "+n}var a=i?this._resolveFunction(i)+"("+r+", "+n+")":n;if(s){var o=new SelectorBuilder(e.left),c=o.params.slice();return c.unshift(this._resolveGetLocal(o.operand)),c.push(a),o.params.length?this._resolveSetName(o.operand,"RT.set("+c.join(", ")+")"):this._resolveSetName(o.operand,a)}return a},s.Callbacks[ASTNode.Types.TernaryExpression]=function(e){return"("+this.visitNode(e.condition)+") "+this.visitNode(e.is_true)+" : "+this.visitNode(e.is_false)},s.Callbacks[ASTNode.Types.IndexSelector]=function(){},s.Callbacks[ASTNode.Types.FieldSelector]=function(){},SelectorBuilder=function(e){r.call(this),this.operand=null,this.params=[],this.visitNode(e)},SelectorBuilder.prototype={constructor:SelectorBuilder,__proto__:r.prototype,visitorForType:function(e){if(e in SelectorBuilder.Callbacks)return SelectorBuilder.Callbacks[e];throw new Error("Unexpected AST node encountered by selector builder.")}},SelectorBuilder.Callbacks={},SelectorBuilder.Callbacks[ASTNode.Types.IntegerLiteral]=function(e){return this.params.push(e.value)},SelectorBuilder.Callbacks[ASTNode.Types.FloatLiteral]=function(e){return this.params.push(e.value)},SelectorBuilder.Callbacks[ASTNode.Types.Identifier]=function(e){return this.operand=e.name},SelectorBuilder.Callbacks[ASTNode.Types.Operator]=function(e){e.operator instanceof ASTNode&&this.visitNode(e.operator)},SelectorBuilder.Callbacks[ASTNode.Types.PostfixExpression]=function(e){this.visitNode(e.expression),this.visitNode(e.operator)},SelectorBuilder.Callbacks[ASTNode.Types.IndexSelector]=function(e){this.visitNode(e.index)},SelectorBuilder.Callbacks[ASTNode.Types.FieldSelector]=function(e){this.params.push("'"+e.selection+"'")},e.exports=s}),e.define("compiler/parser",function(e,t){e.exports=function(){function e(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}function r(e,t,r,n,i,s){this.message=e,this.expected=t,this.found=r,this.offset=n,this.line=i,this.column=s,this.name="SyntaxError"}function n(e){function n(){return e.substring(bc,_c)}function i(){return bc}function s(){return o(bc).line}function a(){return o(bc).column}function o(t){function r(t,r,n){var i,s;for(i=r;n>i;i++)s=e.charAt(i),"\n"===s?(t.seenCR||t.line++,t.column=1,t.seenCR=!1):"\r"===s||"\u2028"===s||"\u2029"===s?(t.line++,t.column=1,t.seenCR=!0):(t.column++,t.seenCR=!1)}return gc!==t&&(gc>t&&(gc=0,Sc={line:1,column:1,seenCR:!1}),r(Sc,gc,t),gc=t),Sc}function c(e){Ac>_c||(_c>Ac&&(Ac=_c,Tc=[]),Tc.push(e))}function u(t,n,i){function s(e){var t=1;for(e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}function a(e,t){function r(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0180-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1080-\uFFFF]/g,function(e){return"\\u"+t(e)})}var n,i,s,a=new Array(e.length);for(s=0;s<e.length;s++)a[s]=e[s].description;return n=e.length>1?a.slice(0,-1).join(", ")+" or "+a[e.length-1]:a[0],i=t?'"'+r(t)+'"':"end of input","Expected "+n+" but "+i+" found."}var c=o(i),u=i<e.length?e.charAt(i):null;return null!==n&&s(n),new r(null!==t?t:a(n,u),n,u,i,c.line,c.column)}function l(){var e;return e=C()}function h(){var t,r;return t=_c,Cr.test(e.charAt(_c))?(r=e.charAt(_c),_c++):(r=Sr,0===xc&&c(wr)),r!==Sr&&(bc=t,r=Lr()),t=r}function p(){var t,r;return t=_c,xc++,e.length>_c?(r=e.charAt(_c),_c++):(r=Sr,0===xc&&c(Nr)),xc--,r===Sr?t=kr:(_c=t,t=xr),t}function d(){var t,r;if(xc++,t=[],r=h(),r===Sr&&(Er.test(e.charAt(_c))?(r=e.charAt(_c),_c++):(r=Sr,0===xc&&c(Pr)),r===Sr&&(jr.test(e.charAt(_c))?(r=e.charAt(_c),_c++):(r=Sr,0===xc&&c(Fr)),r===Sr&&(r=m()))),r!==Sr)for(;r!==Sr;)t.push(r),r=h(),r===Sr&&(Er.test(e.charAt(_c))?(r=e.charAt(_c),_c++):(r=Sr,0===xc&&c(Pr)),r===Sr&&(jr.test(e.charAt(_c))?(r=e.charAt(_c),_c++):(r=Sr,0===xc&&c(Fr)),r===Sr&&(r=m())));else t=xr;return xc--,t===Sr&&(r=Sr,0===xc&&c(Vr)),t}function f(){var t,r,n,i,s,a;if(t=_c,e.substr(_c,2)===Rr?(r=Rr,_c+=2):(r=Sr,0===xc&&c(Or)),r!==Sr){for(n=[],i=_c,s=_c,xc++,e.substr(_c,2)===Mr?(a=Mr,_c+=2):(a=Sr,0===xc&&c(Ir)),xc--,a===Sr?s=kr:(_c=s,s=xr),s!==Sr?(e.length>_c?(a=e.charAt(_c),_c++):(a=Sr,0===xc&&c(Nr)),a!==Sr?(s=[s,a],i=s):(_c=i,i=xr)):(_c=i,i=xr);i!==Sr;)n.push(i),i=_c,s=_c,xc++,e.substr(_c,2)===Mr?(a=Mr,_c+=2):(a=Sr,0===xc&&c(Ir)),xc--,a===Sr?s=kr:(_c=s,s=xr),s!==Sr?(e.length>_c?(a=e.charAt(_c),_c++):(a=Sr,0===xc&&c(Nr)),a!==Sr?(s=[s,a],i=s):(_c=i,i=xr)):(_c=i,i=xr);n!==Sr?(e.substr(_c,2)===Mr?(i=Mr,_c+=2):(i=Sr,0===xc&&c(Ir)),i!==Sr?(r=[r,n,i],t=r):(_c=t,t=xr)):(_c=t,t=xr)}else _c=t,t=xr;if(t===Sr)if(t=_c,e.substr(_c,2)===qr?(r=qr,_c+=2):(r=Sr,0===xc&&c(Dr)),r!==Sr){for(n=[],Br.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(Gr));i!==Sr;)n.push(i),Br.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(Gr));n!==Sr?(r=[r,n],t=r):(_c=t,t=xr)}else _c=t,t=xr;return t}function v(){var t,r;if(t=[],jr.test(e.charAt(_c))?(r=e.charAt(_c),_c++):(r=Sr,0===xc&&c(Fr)),r===Sr&&(r=f()),r!==Sr)for(;r!==Sr;)t.push(r),jr.test(e.charAt(_c))?(r=e.charAt(_c),_c++):(r=Sr,0===xc&&c(Fr)),r===Sr&&(r=f());else t=xr;return t}function m(){var t,r,n,i,s,a;if(xc++,t=_c,e.substr(_c,2)===Rr?(r=Rr,_c+=2):(r=Sr,0===xc&&c(Or)),r!==Sr){for(n=[],i=_c,s=_c,xc++,e.substr(_c,2)===Mr?(a=Mr,_c+=2):(a=Sr,0===xc&&c(Ir)),xc--,a===Sr?s=kr:(_c=s,s=xr),s!==Sr?(e.length>_c?(a=e.charAt(_c),_c++):(a=Sr,0===xc&&c(Nr)),a!==Sr?(s=[s,a],i=s):(_c=i,i=xr)):(_c=i,i=xr);i!==Sr;)n.push(i),i=_c,s=_c,xc++,e.substr(_c,2)===Mr?(a=Mr,_c+=2):(a=Sr,0===xc&&c(Ir)),xc--,a===Sr?s=kr:(_c=s,s=xr),s!==Sr?(e.length>_c?(a=e.charAt(_c),_c++):(a=Sr,0===xc&&c(Nr)),a!==Sr?(s=[s,a],i=s):(_c=i,i=xr)):(_c=i,i=xr);n!==Sr?(e.substr(_c,2)===Mr?(i=Mr,_c+=2):(i=Sr,0===xc&&c(Ir)),i!==Sr?(r=[r,n,i],t=r):(_c=t,t=xr)):(_c=t,t=xr)}else _c=t,t=xr;if(t===Sr)if(t=_c,e.substr(_c,2)===qr?(r=qr,_c+=2):(r=Sr,0===xc&&c(Dr)),r!==Sr){for(n=[],Br.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(Gr));i!==Sr;)n.push(i),Br.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(Gr));n!==Sr?(i=h(),i===Sr&&(i=p()),i!==Sr?(r=[r,n,i],t=r):(_c=t,t=xr)):(_c=t,t=xr)}else _c=t,t=xr;return xc--,t===Sr&&(r=Sr,0===xc&&c(zr)),t}function y(){var t,r,n,i;return t=_c,r=d(),r===Sr&&(r=Ur),r!==Sr?(59===e.charCodeAt(_c)?(n=Qr,_c++):(n=Sr,0===xc&&c(Zr)),n!==Sr?(i=d(),i===Sr&&(i=Ur),i!==Sr?(r=[r,n,i],t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function _(){var t,r,n,i;return t=_c,r=d(),r===Sr&&(r=Ur),r!==Sr?(44===e.charCodeAt(_c)?(n=Wr,_c++):(n=Sr,0===xc&&c(Hr)),n!==Sr?(i=d(),i===Sr&&(i=Ur),i!==Sr?(r=[r,n,i],t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function b(){var t,r,n,i;return t=_c,r=d(),r===Sr&&(r=Ur),r!==Sr?(91===e.charCodeAt(_c)?(n=$r,_c++):(n=Sr,0===xc&&c(Xr)),n!==Sr?(i=d(),i===Sr&&(i=Ur),i!==Sr?(r=[r,n,i],t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function g(){var t,r,n,i;return t=_c,r=d(),r===Sr&&(r=Ur),r!==Sr?(93===e.charCodeAt(_c)?(n=Jr,_c++):(n=Sr,0===xc&&c(Kr)),n!==Sr?(i=d(),i===Sr&&(i=Ur),i!==Sr?(r=[r,n,i],t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function S(){var t,r,n,i;return t=_c,r=d(),r===Sr&&(r=Ur),r!==Sr?(61===e.charCodeAt(_c)?(n=Yr,_c++):(n=Sr,0===xc&&c(en)),n!==Sr?(i=d(),i===Sr&&(i=Ur),i!==Sr?(r=[r,n,i],t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function A(){var t,r,n,i;return t=_c,r=d(),r===Sr&&(r=Ur),r!==Sr?(40===e.charCodeAt(_c)?(n=tn,_c++):(n=Sr,0===xc&&c(rn)),n!==Sr?(i=d(),i===Sr&&(i=Ur),i!==Sr?(r=[r,n,i],t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function T(){var t,r,n,i;return t=_c,r=d(),r===Sr&&(r=Ur),r!==Sr?(41===e.charCodeAt(_c)?(n=nn,_c++):(n=Sr,0===xc&&c(sn)),n!==Sr?(i=d(),i===Sr&&(i=Ur),i!==Sr?(r=[r,n,i],t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function x(){var t,r,n,i;return t=_c,r=d(),r===Sr&&(r=Ur),r!==Sr?(123===e.charCodeAt(_c)?(n=an,_c++):(n=Sr,0===xc&&c(on)),n!==Sr?(i=d(),i===Sr&&(i=Ur),i!==Sr?(r=[r,n,i],t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function k(){var t,r,n,i;return t=_c,r=d(),r===Sr&&(r=Ur),r!==Sr?(125===e.charCodeAt(_c)?(n=cn,_c++):(n=Sr,0===xc&&c(un)),n!==Sr?(i=d(),i===Sr&&(i=Ur),i!==Sr?(r=[r,n,i],t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function C(){var e,t,r;for(e=_c,t=[],r=w();r!==Sr;)t.push(r),r=w();return t!==Sr&&(bc=e,t=ln(t)),e=t}function w(){var e,t;return e=_c,t=I(),t===Sr&&(t=L()),t!==Sr&&(bc=e,t=hn(t)),e=t,e===Sr&&(e=_c,t=d(),t!==Sr&&(bc=e,t=pn()),e=t),e}function L(){var e;return e=D(),e===Sr&&(e=tt(),e===Sr&&(e=j(),e===Sr&&(e=N(),e===Sr&&(e=vt(),e===Sr&&(e=P()))))),e}function N(){var t,r,n,i,s,a,o;if(t=_c,35===e.charCodeAt(_c)?(r=dn,_c++):(r=Sr,0===xc&&c(fn)),r!==Sr)if(e.substr(_c,5)===vn?(n=vn,_c+=5):(n=Sr,0===xc&&c(mn)),n===Sr&&(e.substr(_c,6)===yn?(n=yn,_c+=6):(n=Sr,0===xc&&c(_n)),n===Sr&&(e.substr(_c,7)===bn?(n=bn,_c+=7):(n=Sr,0===xc&&c(gn)),n===Sr&&(e.substr(_c,5)===Sn?(n=Sn,_c+=5):(n=Sr,0===xc&&c(An)),n===Sr&&(e.substr(_c,9)===Tn?(n=Tn,_c+=9):(n=Sr,0===xc&&c(xn)),n===Sr&&(e.substr(_c,4)===kn?(n=kn,_c+=4):(n=Sr,0===xc&&c(Cn))))))),n!==Sr)if(i=d(),i!==Sr){for(s=_c,a=[],Br.test(e.charAt(_c))?(o=e.charAt(_c),_c++):(o=Sr,0===xc&&c(Gr));o!==Sr;)a.push(o),Br.test(e.charAt(_c))?(o=e.charAt(_c),_c++):(o=Sr,0===xc&&c(Gr));a!==Sr&&(bc=s,a=wn(a)),s=a,s!==Sr?(a=h(),a===Sr&&(a=p()),a!==Sr?(bc=t,r=Ln(n,s),t=r):(_c=t,t=xr)):(_c=t,t=xr)}else _c=t,t=xr;else _c=t,t=xr;else _c=t,t=xr;return t}function V(){var t,r,n,i;if(t=_c,Nn.test(e.charAt(_c))?(r=e.charAt(_c),_c++):(r=Sr,0===xc&&c(Vn)),r!==Sr){for(n=[],En.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(Pn));i!==Sr;)n.push(i),En.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(Pn));n!==Sr?(bc=t,r=jn(r,n),t=r):(_c=t,t=xr)}else _c=t,t=xr;return t}function E(){var t,r,n,i,s,a,o;if(t=_c,40===e.charCodeAt(_c)?(r=tn,_c++):(r=Sr,0===xc&&c(rn)),r!==Sr)if(n=V(),n===Sr&&(n=Ur),n!==Sr){for(i=[],s=_c,a=_(),a!==Sr?(o=V(),o!==Sr?(a=[a,o],s=a):(_c=s,s=xr)):(_c=s,s=xr);s!==Sr;)i.push(s),s=_c,a=_(),a!==Sr?(o=V(),o!==Sr?(a=[a,o],s=a):(_c=s,s=xr)):(_c=s,s=xr);i!==Sr?(s=T(),s!==Sr?(bc=t,r=Fn(n,i),t=r):(_c=t,t=xr)):(_c=t,t=xr)}else _c=t,t=xr;else _c=t,t=xr;return t}function P(){var t,r,n,i,s,a;return t=_c,r=V(),r!==Sr?(n=d(),n===Sr&&(n=Ur),n!==Sr?(i=A(),i!==Sr?(s=Dt(),s===Sr&&(s=Ur),s!==Sr?(41===e.charCodeAt(_c)?(a=nn,_c++):(a=Sr,0===xc&&c(sn)),a!==Sr?(bc=t,r=Rn(r,s),t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function j(){var t,r,n,i,s,a,o,u,l,f,v;if(t=_c,35===e.charCodeAt(_c)?(r=dn,_c++):(r=Sr,0===xc&&c(fn)),r!==Sr)if(n=d(),n===Sr&&(n=Ur),n!==Sr)if(e.substr(_c,6)===On?(i=On,_c+=6):(i=Sr,0===xc&&c(Mn)),i!==Sr)if(s=d(),s!==Sr)if(a=V(),a!==Sr)if(o=E(),o===Sr&&(o=Ur),o!==Sr){for(u=[],In.test(e.charAt(_c))?(l=e.charAt(_c),_c++):(l=Sr,0===xc&&c(qn));l!==Sr;)u.push(l),In.test(e.charAt(_c))?(l=e.charAt(_c),_c++):(l=Sr,0===xc&&c(qn));if(u!==Sr){for(l=_c,f=[],Br.test(e.charAt(_c))?(v=e.charAt(_c),_c++):(v=Sr,0===xc&&c(Gr));v!==Sr;)f.push(v),Br.test(e.charAt(_c))?(v=e.charAt(_c),_c++):(v=Sr,0===xc&&c(Gr));f!==Sr&&(bc=l,f=wn(f)),l=f,l!==Sr?(f=h(),f===Sr&&(f=p()),f!==Sr?(bc=t,r=Dn(a,o,l),t=r):(_c=t,t=xr)):(_c=t,t=xr)}else _c=t,t=xr}else _c=t,t=xr;else _c=t,t=xr;else _c=t,t=xr;else _c=t,t=xr;else _c=t,t=xr;else _c=t,t=xr;return t}function F(){var t,r,n,i,s,a,o,u;if(t=_c,35===e.charCodeAt(_c)?(r=dn,_c++):(r=Sr,0===xc&&c(fn)),r!==Sr)if(n=d(),n===Sr&&(n=Ur),n!==Sr)if(e.substr(_c,5)===Bn?(i=Bn,_c+=5):(i=Sr,0===xc&&c(Gn)),i===Sr&&(e.substr(_c,6)===zn?(i=zn,_c+=6):(i=Sr,0===xc&&c(Un)),i===Sr&&(e.substr(_c,2)===Qn?(i=Qn,_c+=2):(i=Sr,0===xc&&c(Zn)))),i!==Sr)if(s=d(),s!==Sr){for(a=_c,o=[],Br.test(e.charAt(_c))?(u=e.charAt(_c),_c++):(u=Sr,0===xc&&c(Gr));u!==Sr;)o.push(u),Br.test(e.charAt(_c))?(u=e.charAt(_c),_c++):(u=Sr,0===xc&&c(Gr));o!==Sr&&(bc=a,o=wn(o)),a=o,a!==Sr?(o=h(),o===Sr&&(o=p()),o!==Sr?(bc=t,r=Wn(i,a),t=r):(_c=t,t=xr)):(_c=t,t=xr)}else _c=t,t=xr;else _c=t,t=xr;else _c=t,t=xr;else _c=t,t=xr;return t}function R(){var t,r,n,i,s,a,o,u;if(t=_c,35===e.charCodeAt(_c)?(r=dn,_c++):(r=Sr,0===xc&&c(fn)),r!==Sr)if(n=d(),n===Sr&&(n=Ur),n!==Sr)if(e.substr(_c,4)===Hn?(i=Hn,_c+=4):(i=Sr,0===xc&&c($n)),i!==Sr)if(s=d(),s!==Sr){for(a=_c,o=[],Br.test(e.charAt(_c))?(u=e.charAt(_c),_c++):(u=Sr,0===xc&&c(Gr));u!==Sr;)o.push(u),Br.test(e.charAt(_c))?(u=e.charAt(_c),_c++):(u=Sr,0===xc&&c(Gr));o!==Sr&&(bc=a,o=wn(o)),a=o,a!==Sr?(o=h(),o===Sr&&(o=p()),o!==Sr?(bc=t,r=Xn(a),t=r):(_c=t,t=xr)):(_c=t,t=xr)}else _c=t,t=xr;else _c=t,t=xr;else _c=t,t=xr;else _c=t,t=xr;return t}function O(){var t,r,n,i,s,a;return t=_c,35===e.charCodeAt(_c)?(r=dn,_c++):(r=Sr,0===xc&&c(fn)),r!==Sr?(n=d(),n===Sr&&(n=Ur),n!==Sr?(e.substr(_c,4)===Jn?(i=Jn,_c+=4):(i=Sr,0===xc&&c(Kn)),i!==Sr?(s=v(),s===Sr&&(s=Ur),s!==Sr?(a=h(),a!==Sr?(bc=t,r=Yn(),t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function M(){var t,r,n,i,s,a,o;return t=_c,35===e.charCodeAt(_c)?(r=dn,_c++):(r=Sr,0===xc&&c(fn)),r!==Sr?(n=d(),n===Sr&&(n=Ur),n!==Sr?(e.substr(_c,5)===ei?(i=ei,_c+=5):(i=Sr,0===xc&&c(ti)),i!==Sr?(s=v(),s===Sr&&(s=Ur),s!==Sr?(a=h(),a===Sr&&(a=p()),a!==Sr?(o=d(),o===Sr&&(o=Ur),o!==Sr?(r=[r,n,i,s,a,o],t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function I(){var e,t,r,n,i,s;if(e=_c,t=_c,r=F(),r!==Sr?(n=C(),n!==Sr?(r=[r,n],t=r):(_c=t,t=xr)):(_c=t,t=xr),t!==Sr){for(r=[],n=_c,i=R(),i!==Sr?(s=C(),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=R(),i!==Sr?(s=C(),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(n=_c,i=O(),i!==Sr?(s=C(),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr),n===Sr&&(n=Ur),n!==Sr?(i=M(),i!==Sr?(bc=e,t=ri(t,r,n),e=t):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr)}else _c=e,e=xr;return e}function q(){var e,t,r,n,i,s;if(e=_c,t=_c,r=F(),r!==Sr?(n=G(),n!==Sr?(r=[r,n],t=r):(_c=t,t=xr)):(_c=t,t=xr),t!==Sr){for(r=[],n=_c,i=R(),i!==Sr?(s=G(),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=R(),i!==Sr?(s=G(),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(n=_c,i=O(),i!==Sr?(s=G(),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr),n===Sr&&(n=Ur),n!==Sr?(i=M(),i!==Sr?(bc=e,t=ri(t,r,n),e=t):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr)}else _c=e,e=xr;return e}function D(){var e,t,r;return e=_c,t=nt(),t!==Sr?(r=B(),r!==Sr?(bc=e,t=ni(t,r),e=t):(_c=e,e=xr)):(_c=e,e=xr),e}function B(){var e,t,r,n;return e=_c,t=x(),t!==Sr?(r=G(),r===Sr&&(r=Ur),r!==Sr?(n=k(),n!==Sr?(bc=e,t=ii(r),e=t):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr),e}function G(){var e,t,r,n;if(e=_c,t=d(),t===Sr&&(t=Ur),t!==Sr){for(r=[],n=z();n!==Sr;)r.push(n),n=z();r!==Sr?(n=d(),n===Sr&&(n=Ur),n!==Sr?(bc=e,t=si(r),e=t):(_c=e,e=xr)):(_c=e,e=xr)}else _c=e,e=xr;return e}function z(){var e;return e=B(),e===Sr&&(e=Q(),e===Sr&&(e=q())),e}function U(){var e;return e=B(),e===Sr&&(e=Q(),e===Sr&&(e=q())),e}function Q(){var e,t;return e=_c,t=et(),t===Sr&&(t=Y(),t===Sr&&(t=Z(),t===Sr&&(t=J(),t===Sr&&(t=K(),t===Sr&&(t=j(),t===Sr&&(t=N(),t===Sr&&(t=P()))))))),t!==Sr&&(bc=e,t=ai(t)),e=t}function Z(){var t,r,n,i,s,a,o,u,l,h;return t=_c,e.substr(_c,2)===Qn?(r=Qn,_c+=2):(r=Sr,0===xc&&c(Zn)),r!==Sr?(n=A(),n!==Sr?(i=dr(),i!==Sr?(s=T(),s!==Sr?(a=U(),a!==Sr?(o=_c,e.substr(_c,4)===Jn?(u=Jn,_c+=4):(u=Sr,0===xc&&c(Kn)),u!==Sr?(l=d(),l===Sr&&(l=Ur),l!==Sr?(h=U(),h!==Sr?(u=[u,l,h],o=u):(_c=o,o=xr)):(_c=o,o=xr)):(_c=o,o=xr),o===Sr&&(o=Ur),o!==Sr?(bc=t,r=oi(i,a,o),t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function W(){var t,r,n,i,s,a,o,u,l;return t=_c,e.substr(_c,3)===ci?(r=ci,_c+=3):(r=Sr,0===xc&&c(ui)),r!==Sr?(n=A(),n!==Sr?(i=Y(),i===Sr&&(i=et()),i!==Sr?(s=fr(),s===Sr&&(s=Ur),s!==Sr?(a=y(),a!==Sr?(o=dr(),o===Sr&&(o=Ur),o!==Sr?(u=T(),u!==Sr?(l=z(),l!==Sr?(bc=t,r=li(i,s,o,l),t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function H(){var t,r,n,i,s;return t=_c,e.substr(_c,5)===hi?(r=hi,_c+=5):(r=Sr,0===xc&&c(pi)),r!==Sr?(n=A(),n!==Sr?(i=fr(),i!==Sr?(s=T(),s!==Sr?(bc=t,r=di(i),t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function $(){var e,t,r;return e=_c,t=H(),t!==Sr?(r=z(),r!==Sr?(bc=e,t=fi(t,r),e=t):(_c=e,e=xr)):(_c=e,e=xr),e}function X(){var t,r,n,i;return t=_c,e.substr(_c,2)===vi?(r=vi,_c+=2):(r=Sr,0===xc&&c(mi)),r!==Sr?(n=U(),n!==Sr?(i=H(),i!==Sr?(bc=t,r=yi(n,i),t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function J(){var e;return e=$(),e===Sr&&(e=X(),e===Sr&&(e=W())),e}function K(){var t,r,n,i,s;return t=_c,e.substr(_c,6)===_i?(r=_i,_c+=6):(r=Sr,0===xc&&c(bi)),r!==Sr?(n=dr(),n!==Sr?(i=y(),i!==Sr?(bc=t,r=gi(n),t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t===Sr&&(t=_c,r=_c,e.substr(_c,8)===Si?(n=Si,_c+=8):(n=Sr,0===xc&&c(Ai)),n!==Sr?(i=y(),i!==Sr?(n=[n,i],r=n):(_c=r,r=xr)):(_c=r,r=xr),r===Sr&&(r=_c,e.substr(_c,5)===Ti?(n=Ti,_c+=5):(n=Sr,0===xc&&c(xi)),n!==Sr?(i=y(),i!==Sr?(n=[n,i],r=n):(_c=r,r=xr)):(_c=r,r=xr),r===Sr&&(r=_c,e.substr(_c,6)===_i?(n=_i,_c+=6):(n=Sr,0===xc&&c(bi)),n!==Sr?(i=y(),i!==Sr?(n=[n,i],r=n):(_c=r,r=xr)):(_c=r,r=xr),r===Sr&&(r=_c,n=_c,bc=_c,i=ki(),i=i?kr:xr,i!==Sr?(e.substr(_c,7)===Ci?(s=Ci,_c+=7):(s=Sr,0===xc&&c(wi)),s!==Sr?(bc=n,i=Li(),n=i):(_c=n,n=xr)):(_c=n,n=xr),n!==Sr?(i=y(),i!==Sr?(n=[n,i],r=n):(_c=r,r=xr)):(_c=r,r=xr)))),r!==Sr&&(bc=t,r=Ni(r)),t=r),t}function Y(){var e,t,r;return e=_c,t=dr(),t===Sr&&(t=Ur),t!==Sr?(r=y(),r!==Sr?(bc=e,t=Vi(t),e=t):(_c=e,e=xr)):(_c=e,e=xr),e}function et(){var t,r,n,i,s,a,o,u,l;if(xc++,t=_c,r=nt(),r!==Sr?(n=y(),n!==Sr?(bc=t,r=Pi(r),t=r):(_c=t,t=xr)):(_c=t,t=xr),t===Sr&&(t=_c,r=yt(),r!==Sr?(n=d(),n!==Sr?(i=at(),i!==Sr?(s=y(),s!==Sr?(bc=t,r=ji(r,i),t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t===Sr)){if(t=_c,bc=_c,r=Fi(),r=r?kr:xr,r!==Sr)if(e.substr(_c,9)===Ri?(n=Ri,_c+=9):(n=Sr,0===xc&&c(Oi)),n!==Sr)if(i=d(),i!==Sr)if(s=Ct(),s!==Sr){for(a=[],o=_c,u=_(),u!==Sr?(l=Ct(),l!==Sr?(u=[u,l],o=u):(_c=o,o=xr)):(_c=o,o=xr);o!==Sr;)a.push(o),o=_c,u=_(),u!==Sr?(l=Ct(),l!==Sr?(u=[u,l],o=u):(_c=o,o=xr)):(_c=o,o=xr);a!==Sr?(o=y(),o!==Sr?(bc=t,r=Mi(s,a),t=r):(_c=t,t=xr)):(_c=t,t=xr)}else _c=t,t=xr;else _c=t,t=xr;else _c=t,t=xr;else _c=t,t=xr;t===Sr&&(t=_c,e.substr(_c,9)===Ii?(r=Ii,_c+=9):(r=Sr,0===xc&&c(qi)),r!==Sr?(n=d(),n!==Sr?(i=St(),i!==Sr?(s=d(),s!==Sr?(a=kt(),a!==Sr?(o=y(),o!==Sr?(bc=t,r=Di(i,a),t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr))}return xc--,t===Sr&&(r=Sr,0===xc&&c(Ei)),t}function tt(){var e,t,r,n,i;return e=et(),e===Sr&&(e=_c,t=gt(),t!==Sr?(r=d(),r!==Sr?(n=at(),n!==Sr?(i=y(),i!==Sr?(bc=e,t=Bi(t,n),e=t):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr),e===Sr&&(e=_c,t=bt(),t!==Sr?(r=d(),r!==Sr?(n=ct(),n!==Sr?(i=y(),i!==Sr?(bc=e,t=Bi(t,n),e=t):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr))),e}function rt(){var t,r,n,i,s,a;if(e.substr(_c,4)===Gi?(t=Gi,_c+=4):(t=Sr,0===xc&&c(zi)),t===Sr)if(t=_c,r=st(),r!==Sr){for(n=[],i=_c,s=_(),s!==Sr?(a=st(),a!==Sr?(s=[s,a],i=s):(_c=i,i=xr)):(_c=i,i=xr);i!==Sr;)n.push(i),i=_c,s=_(),s!==Sr?(a=st(),a!==Sr?(s=[s,a],i=s):(_c=i,i=xr)):(_c=i,i=xr);n!==Sr?(bc=t,r=Ui(r,n),t=r):(_c=t,t=xr)}else _c=t,t=xr;return t}function nt(){var e,t,r,n,i,s,a;return e=_c,t=xt(),t===Sr&&(t=mt()),t!==Sr?(r=d(),r!==Sr?(n=Ct(),n!==Sr?(i=A(),i!==Sr?(s=rt(),s===Sr&&(s=Ur),s!==Sr?(a=T(),a!==Sr?(bc=e,t=Qi(t,n,s),e=t):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr),e}function it(){var t;return e.substr(_c,5)===Zi?(t=Zi,_c+=5):(t=Sr,0===xc&&c(Wi)),t===Sr&&(e.substr(_c,2)===Hi?(t=Hi,_c+=2):(t=Sr,0===xc&&c($i)),t===Sr&&(e.substr(_c,3)===Xi?(t=Xi,_c+=3):(t=Sr,0===xc&&c(Ji)))),t}function st(){var e,t,r,n,i,s,a,o,c,u,l;return e=_c,t=_c,r=At(),r!==Sr?(n=d(),n!==Sr?(r=[r,n],t=r):(_c=t,t=xr)):(_c=t,t=xr),t===Sr&&(t=Ur),t!==Sr?(r=_c,n=it(),n!==Sr?(i=d(),i!==Sr?(n=[n,i],r=n):(_c=r,r=xr)):(_c=r,r=xr),r===Sr&&(r=Ur),r!==Sr?(n=_c,i=St(),i!==Sr?(s=d(),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr),n===Sr&&(n=Ur),n!==Sr?(i=kt(),i!==Sr?(s=d(),s!==Sr?(a=Ct(),a!==Sr?(o=_c,c=b(),c!==Sr?(u=pr(),u!==Sr?(l=g(),l!==Sr?(c=[c,u,l],o=c):(_c=o,o=xr)):(_c=o,o=xr)):(_c=o,o=xr),o===Sr&&(o=Ur),o!==Sr?(bc=e,t=Ki(t,r,n,i,a,o),e=t):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr),e}function at(){var e,t,r,n,i,s;if(e=_c,t=dt(),t!==Sr){for(r=[],n=_c,i=_(),i!==Sr?(s=dt(),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=_(),i!==Sr?(s=dt(),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(bc=e,t=Yi(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function ot(){var e,t,r,n,i,s;if(e=_c,t=pt(),t!==Sr){for(r=[],n=_c,i=_(),i!==Sr?(s=pt(),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=_(),i!==Sr?(s=pt(),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(bc=e,t=Yi(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function ct(){var e,t,r,n,i,s;if(e=_c,t=lt(),t!==Sr){for(r=[],n=_c,i=_(),i!==Sr?(s=lt(),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=_(),i!==Sr?(s=lt(),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(bc=e,t=Yi(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function ut(){var e,t,r,n,i,s;if(e=_c,t=ht(),t!==Sr){for(r=[],n=_c,i=_(),i!==Sr?(s=ht(),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=_(),i!==Sr?(s=ht(),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(bc=e,t=Yi(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function lt(){var e,t;return e=_c,t=Ct(),t!==Sr&&(bc=e,t=es(t)),e=t}function ht(){var e,t,r,n,i;return e=_c,t=Ct(),t!==Sr?(r=b(),r!==Sr?(n=pr(),n!==Sr?(i=g(),i!==Sr?(bc=e,t=ts(t,n),e=t):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr),e===Sr&&(e=lt()),e}function pt(){var e,t,r,n;return e=_c,t=Ct(),t!==Sr?(r=b(),r!==Sr?(n=g(),n!==Sr?(bc=e,t=rs(t),e=t):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr),e===Sr&&(e=ht()),e}function dt(){var e,t,r,n;return e=_c,t=Ct(),t!==Sr?(r=S(),r!==Sr?(n=pr(),n!==Sr?(bc=e,t=ns(t,n),e=t):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr),e===Sr&&(e=pt()),e}function ft(){var e,t,r,n,i,s,a;if(e=_c,t=[],r=_c,n=yt(),n!==Sr?(i=d(),i!==Sr?(s=ut(),s!==Sr?(a=y(),a!==Sr?(n=[n,i,s,a],r=n):(_c=r,r=xr)):(_c=r,r=xr)):(_c=r,r=xr)):(_c=r,r=xr),r!==Sr)for(;r!==Sr;)t.push(r),r=_c,n=yt(),n!==Sr?(i=d(),i!==Sr?(s=ut(),s!==Sr?(a=y(),a!==Sr?(n=[n,i,s,a],r=n):(_c=r,r=xr)):(_c=r,r=xr)):(_c=r,r=xr)):(_c=r,r=xr);else t=xr;return t!==Sr&&(bc=e,t=is(t)),e=t}function vt(){var t,r,n,i,s,a,o,u,l;return t=_c,r=_c,n=Tt(),n===Sr&&(n=_t()),n!==Sr?(i=d(),i!==Sr?(n=[n,i],r=n):(_c=r,r=xr)):(_c=r,r=xr),r===Sr&&(r=Ur),r!==Sr?(e.substr(_c,6)===ss?(n=ss,_c+=6):(n=Sr,0===xc&&c(as)),n!==Sr?(i=_c,s=d(),s!==Sr?(a=Ct(),a!==Sr?(s=[s,a],i=s):(_c=i,i=xr)):(_c=i,i=xr),i===Sr&&(i=Ur),i!==Sr?(s=x(),s!==Sr?(a=ft(),a!==Sr?(o=k(),o!==Sr?(u=ot(),u===Sr&&(u=Ur),u!==Sr?(l=y(),l!==Sr?(bc=t,r=os(r,i,a,u),t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t
}function mt(){var e,t,r,n;return e=_c,t=_c,r=St(),r!==Sr?(n=d(),n!==Sr?(r=[r,n],t=r):(_c=t,t=xr)):(_c=t,t=xr),t===Sr&&(t=Ur),t!==Sr?(r=kt(),r!==Sr?(bc=e,t=cs(t,r),e=t):(_c=e,e=xr)):(_c=e,e=xr),e}function yt(){var e,t,r,n;return xc++,e=_c,t=_c,r=At(),r!==Sr?(n=d(),n!==Sr?(r=[r,n],t=r):(_c=t,t=xr)):(_c=t,t=xr),t===Sr&&(t=Ur),t!==Sr?(r=mt(),r!==Sr?(bc=e,t=ls(t,r),e=t):(_c=e,e=xr)):(_c=e,e=xr),xc--,e===Sr&&(t=Sr,0===xc&&c(us)),e}function _t(){var t,r,n;return t=_c,bc=_c,r=Fi(),r=r?kr:xr,r!==Sr?(e.substr(_c,9)===hs?(n=hs,_c+=9):(n=Sr,0===xc&&c(ps)),n!==Sr?(bc=t,r=ds(),t=r):(_c=t,t=xr)):(_c=t,t=xr),t}function bt(){var e,t,r,n;return xc++,e=_c,t=_t(),t!==Sr?(r=d(),r!==Sr?(n=mt(),n!==Sr?(bc=e,t=fs(t,n),e=t):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr),xc--,e===Sr&&(t=Sr,0===xc&&c(us)),e}function gt(){var e,t,r,n;return xc++,e=_c,t=_c,r=Tt(),r!==Sr?(n=d(),n!==Sr?(r=[r,n],t=r):(_c=t,t=xr)):(_c=t,t=xr),t===Sr&&(t=Ur),t!==Sr?(r=mt(),r!==Sr?(bc=e,t=ls(t,r),e=t):(_c=e,e=xr)):(_c=e,e=xr),xc--,e===Sr&&(t=Sr,0===xc&&c(vs)),e}function St(){var t,r;return xc++,e.substr(_c,5)===ys?(t=ys,_c+=5):(t=Sr,0===xc&&c(_s)),t===Sr&&(e.substr(_c,7)===bs?(t=bs,_c+=7):(t=Sr,0===xc&&c(gs)),t===Sr&&(e.substr(_c,4)===Ss?(t=Ss,_c+=4):(t=Sr,0===xc&&c(As)))),xc--,t===Sr&&(r=Sr,0===xc&&c(ms)),t}function At(){var t;return e.substr(_c,5)===Ts?(t=Ts,_c+=5):(t=Sr,0===xc&&c(xs)),t}function Tt(){var t,r,n,i;return xc++,t=At(),t===Sr&&(e.substr(_c,7)===Cs?(t=Cs,_c+=7):(t=Sr,0===xc&&c(ws)),t===Sr&&(t=_c,e.substr(_c,9)===Ri?(r=Ri,_c+=9):(r=Sr,0===xc&&c(Oi)),r!==Sr?(n=d(),n!==Sr?(e.substr(_c,7)===Cs?(i=Cs,_c+=7):(i=Sr,0===xc&&c(ws)),i!==Sr?(bc=t,r=Ls(),t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t===Sr&&(e.substr(_c,7)===Ns?(t=Ns,_c+=7):(t=Sr,0===xc&&c(Vs))))),xc--,t===Sr&&(r=Sr,0===xc&&c(ks)),t}function xt(){var t,r;return xc++,t=_c,e.substr(_c,4)===Gi?(r=Gi,_c+=4):(r=Sr,0===xc&&c(zi)),r!==Sr&&(bc=t,r=Ps()),t=r,xc--,t===Sr&&(r=Sr,0===xc&&c(Es)),t}function kt(){var t,r;return xc++,e.substr(_c,5)===Fs?(t=Fs,_c+=5):(t=Sr,0===xc&&c(Rs)),t===Sr&&(e.substr(_c,3)===Os?(t=Os,_c+=3):(t=Sr,0===xc&&c(Ms)),t===Sr&&(e.substr(_c,4)===Is?(t=Is,_c+=4):(t=Sr,0===xc&&c(qs)),t===Sr&&(e.substr(_c,9)===Ds?(t=Ds,_c+=9):(t=Sr,0===xc&&c(Bs)),t===Sr&&(e.substr(_c,11)===Gs?(t=Gs,_c+=11):(t=Sr,0===xc&&c(zs)),t===Sr&&(t=Lt(),t===Sr&&(t=Nt(),t===Sr&&(t=_c,r=Ct(),r!==Sr&&(bc=t,r=Us(r)),t=r))))))),xc--,t===Sr&&(r=Sr,0===xc&&c(js)),t}function Ct(){var t,r,n,i,s;if(xc++,t=_c,r=_c,xc++,n=_c,i=wt(),i!==Sr?(Zs.test(e.charAt(_c))?(s=e.charAt(_c),_c++):(s=Sr,0===xc&&c(Ws)),s!==Sr?(i=[i,s],n=i):(_c=n,n=xr)):(_c=n,n=xr),xc--,n===Sr?r=kr:(_c=r,r=xr),r!==Sr)if(Nn.test(e.charAt(_c))?(n=e.charAt(_c),_c++):(n=Sr,0===xc&&c(Vn)),n!==Sr){for(i=[],En.test(e.charAt(_c))?(s=e.charAt(_c),_c++):(s=Sr,0===xc&&c(Pn));s!==Sr;)i.push(s),En.test(e.charAt(_c))?(s=e.charAt(_c),_c++):(s=Sr,0===xc&&c(Pn));i!==Sr?(bc=t,r=jn(n,i),t=r):(_c=t,t=xr)}else _c=t,t=xr;else _c=t,t=xr;return xc--,t===Sr&&(r=Sr,0===xc&&c(Qs)),t}function wt(){var t,r;return xc++,e.substr(_c,9)===hs?(t=hs,_c+=9):(t=Sr,0===xc&&c(ps)),t===Sr&&(e.substr(_c,5)===Ts?(t=Ts,_c+=5):(t=Sr,0===xc&&c(xs)),t===Sr&&(e.substr(_c,4)===Is?(t=Is,_c+=4):(t=Sr,0===xc&&c(qs)),t===Sr&&(e.substr(_c,5)===Fs?(t=Fs,_c+=5):(t=Sr,0===xc&&c(Rs)),t===Sr&&(e.substr(_c,3)===Os?(t=Os,_c+=3):(t=Sr,0===xc&&c(Ms)),t===Sr&&(e.substr(_c,5)===Ti?(t=Ti,_c+=5):(t=Sr,0===xc&&c(xi)),t===Sr&&(e.substr(_c,8)===Si?(t=Si,_c+=8):(t=Sr,0===xc&&c(Ai)),t===Sr&&(e.substr(_c,2)===vi?(t=vi,_c+=2):(t=Sr,0===xc&&c(mi)),t===Sr&&(e.substr(_c,4)===Jn?(t=Jn,_c+=4):(t=Sr,0===xc&&c(Kn)),t===Sr&&(e.substr(_c,3)===ci?(t=ci,_c+=3):(t=Sr,0===xc&&c(ui)),t===Sr&&(e.substr(_c,2)===Qn?(t=Qn,_c+=2):(t=Sr,0===xc&&c(Zn)),t===Sr&&(e.substr(_c,7)===Ci?(t=Ci,_c+=7):(t=Sr,0===xc&&c(wi)),t===Sr&&(e.substr(_c,6)===_i?(t=_i,_c+=6):(t=Sr,0===xc&&c(bi)),t===Sr&&(t=Lt(),t===Sr&&(t=Nt(),t===Sr&&(e.substr(_c,2)===Hi?(t=Hi,_c+=2):(t=Sr,0===xc&&c($i)),t===Sr&&(e.substr(_c,3)===Xi?(t=Xi,_c+=3):(t=Sr,0===xc&&c(Ji)),t===Sr&&(e.substr(_c,5)===Zi?(t=Zi,_c+=5):(t=Sr,0===xc&&c(Wi)),t===Sr&&(e.substr(_c,7)===Ns?(t=Ns,_c+=7):(t=Sr,0===xc&&c(Vs)),t===Sr&&(e.substr(_c,7)===Cs?(t=Cs,_c+=7):(t=Sr,0===xc&&c(ws)),t===Sr&&(e.substr(_c,9)===Ds?(t=Ds,_c+=9):(t=Sr,0===xc&&c(Bs)),t===Sr&&(e.substr(_c,11)===Gs?(t=Gs,_c+=11):(t=Sr,0===xc&&c(zs)),t===Sr&&(e.substr(_c,6)===ss?(t=ss,_c+=6):(t=Sr,0===xc&&c(as)),t===Sr&&(e.substr(_c,4)===Gi?(t=Gi,_c+=4):(t=Sr,0===xc&&c(zi)),t===Sr&&(e.substr(_c,5)===hi?(t=hi,_c+=5):(t=Sr,0===xc&&c(pi)),t===Sr&&(e.substr(_c,5)===ys?(t=ys,_c+=5):(t=Sr,0===xc&&c(_s)),t===Sr&&(e.substr(_c,7)===bs?(t=bs,_c+=7):(t=Sr,0===xc&&c(gs)),t===Sr&&(e.substr(_c,4)===Ss?(t=Ss,_c+=4):(t=Sr,0===xc&&c(As)),t===Sr&&(e.substr(_c,4)===$s?(t=$s,_c+=4):(t=Sr,0===xc&&c(Xs)),t===Sr&&(e.substr(_c,5)===Js?(t=Js,_c+=5):(t=Sr,0===xc&&c(Ks))))))))))))))))))))))))))))))),xc--,t===Sr&&(r=Sr,0===xc&&c(Hs)),t}function Lt(){var t,r,n,i,s;return t=_c,r=_c,Ys.test(e.charAt(_c))?(n=e.charAt(_c),_c++):(n=Sr,0===xc&&c(ea)),n===Sr&&(n=Ur),n!==Sr?(e.substr(_c,3)===ta?(i=ta,_c+=3):(i=Sr,0===xc&&c(ra)),i!==Sr?(na.test(e.charAt(_c))?(s=e.charAt(_c),_c++):(s=Sr,0===xc&&c(ia)),s!==Sr?(n=[n,i,s],r=n):(_c=r,r=xr)):(_c=r,r=xr)):(_c=r,r=xr),r!==Sr&&(bc=t,r=sa(r)),t=r}function Nt(){var t,r,n,i;return t=_c,r=_c,e.substr(_c,3)===aa?(n=aa,_c+=3):(n=Sr,0===xc&&c(oa)),n!==Sr?(na.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(ia)),i!==Sr?(n=[n,i],r=n):(_c=r,r=xr)):(_c=r,r=xr),r!==Sr&&(bc=t,r=sa(r)),t=r}function Vt(){var t,r,n,i,s;if(t=_c,ca.test(e.charAt(_c))?(r=e.charAt(_c),_c++):(r=Sr,0===xc&&c(ua)),r!==Sr){for(n=[],la.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(ha));i!==Sr;)n.push(i),la.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(ha));n!==Sr?(bc=t,r=pa(r,n),t=r):(_c=t,t=xr)}else _c=t,t=xr;if(t===Sr){if(t=_c,48===e.charCodeAt(_c)?(r=da,_c++):(r=Sr,0===xc&&c(fa)),r!==Sr)if(va.test(e.charAt(_c))?(n=e.charAt(_c),_c++):(n=Sr,0===xc&&c(ma)),n!==Sr){if(i=[],ya.test(e.charAt(_c))?(s=e.charAt(_c),_c++):(s=Sr,0===xc&&c(_a)),s!==Sr)for(;s!==Sr;)i.push(s),ya.test(e.charAt(_c))?(s=e.charAt(_c),_c++):(s=Sr,0===xc&&c(_a));else i=xr;i!==Sr?(bc=t,r=ba(i),t=r):(_c=t,t=xr)}else _c=t,t=xr;else _c=t,t=xr;if(t===Sr){if(t=_c,48===e.charCodeAt(_c)?(r=da,_c++):(r=Sr,0===xc&&c(fa)),r!==Sr){if(n=[],ga.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(Sa)),i!==Sr)for(;i!==Sr;)n.push(i),ga.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(Sa));else n=xr;n!==Sr?(bc=t,r=Aa(n),t=r):(_c=t,t=xr)}else _c=t,t=xr;t===Sr&&(t=_c,48===e.charCodeAt(_c)?(r=da,_c++):(r=Sr,0===xc&&c(fa)),r!==Sr&&(bc=t,r=Ta()),t=r)}}return t}function Et(){var t,r,n,i,s,a;for(t=_c,r=_c,n=[],la.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(ha));i!==Sr;)n.push(i),la.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(ha));if(n!==Sr)if(46===e.charCodeAt(_c)?(i=xa,_c++):(i=Sr,0===xc&&c(ka)),i!==Sr){if(s=[],la.test(e.charAt(_c))?(a=e.charAt(_c),_c++):(a=Sr,0===xc&&c(ha)),a!==Sr)for(;a!==Sr;)s.push(a),la.test(e.charAt(_c))?(a=e.charAt(_c),_c++):(a=Sr,0===xc&&c(ha));else s=xr;s!==Sr?(a=Pt(),a===Sr&&(a=Ur),a!==Sr?(n=[n,i,s,a],r=n):(_c=r,r=xr)):(_c=r,r=xr)}else _c=r,r=xr;else _c=r,r=xr;if(r===Sr){if(r=_c,n=[],la.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(ha)),i!==Sr)for(;i!==Sr;)n.push(i),la.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(ha));else n=xr;if(n!==Sr)if(46===e.charCodeAt(_c)?(i=xa,_c++):(i=Sr,0===xc&&c(ka)),i!==Sr){for(s=[],la.test(e.charAt(_c))?(a=e.charAt(_c),_c++):(a=Sr,0===xc&&c(ha));a!==Sr;)s.push(a),la.test(e.charAt(_c))?(a=e.charAt(_c),_c++):(a=Sr,0===xc&&c(ha));s!==Sr?(a=Pt(),a===Sr&&(a=Ur),a!==Sr?(n=[n,i,s,a],r=n):(_c=r,r=xr)):(_c=r,r=xr)}else _c=r,r=xr;else _c=r,r=xr}if(r!==Sr&&(bc=t,r=Ca(r)),t=r,t===Sr){if(t=_c,r=_c,n=[],la.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(ha)),i!==Sr)for(;i!==Sr;)n.push(i),la.test(e.charAt(_c))?(i=e.charAt(_c),_c++):(i=Sr,0===xc&&c(ha));else n=xr;n!==Sr?(i=Pt(),i!==Sr?(n=[n,i],r=n):(_c=r,r=xr)):(_c=r,r=xr),r!==Sr&&(bc=t,r=wa(r)),t=r}return t}function Pt(){var t,r,n,i,s;if(t=_c,La.test(e.charAt(_c))?(r=e.charAt(_c),_c++):(r=Sr,0===xc&&c(Na)),r!==Sr)if(Va.test(e.charAt(_c))?(n=e.charAt(_c),_c++):(n=Sr,0===xc&&c(Ea)),n===Sr&&(n=Ur),n!==Sr){if(i=[],la.test(e.charAt(_c))?(s=e.charAt(_c),_c++):(s=Sr,0===xc&&c(ha)),s!==Sr)for(;s!==Sr;)i.push(s),la.test(e.charAt(_c))?(s=e.charAt(_c),_c++):(s=Sr,0===xc&&c(ha));else i=xr;i!==Sr?(bc=t,r=Pa(n,i),t=r):(_c=t,t=xr)}else _c=t,t=xr;else _c=t,t=xr;return t}function jt(){var e,t,r,n;return e=_c,t=A(),t!==Sr?(r=dr(),r!==Sr?(n=T(),n!==Sr?(bc=e,t=ja(r),e=t):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr),e}function Ft(){var t,r;return t=_c,e.substr(_c,4)===$s?(r=$s,_c+=4):(r=Sr,0===xc&&c(Xs)),r===Sr&&(e.substr(_c,5)===Js?(r=Js,_c+=5):(r=Sr,0===xc&&c(Ks))),r!==Sr&&(bc=t,r=Fa(r)),t=r}function Rt(){var e;return e=Bt(),e===Sr&&(e=Ct(),e===Sr&&(e=Et(),e===Sr&&(e=Vt(),e===Sr&&(e=Ft(),e===Sr&&(e=jt()))))),e}function Ot(){var e,t,r,n;return e=_c,t=b(),t!==Sr?(r=dr(),r!==Sr?(n=g(),n!==Sr?(bc=e,t=Ra(r),e=t):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr),e}function Mt(){var t,r,n;return t=_c,46===e.charCodeAt(_c)?(r=xa,_c++):(r=Sr,0===xc&&c(ka)),r!==Sr?(n=Ct(),n!==Sr?(bc=t,r=Oa(n),t=r):(_c=t,t=xr)):(_c=t,t=xr),t}function It(){var e,t,r,n;if(e=_c,t=Rt(),t!==Sr){for(r=[],n=Mt(),n===Sr&&(n=Ot());n!==Sr;)r.push(n),n=Mt(),n===Sr&&(n=Ot());r!==Sr?(bc=e,t=Ma(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function qt(){var t,r,n,i,s,a;if(t=_c,r=It(),r!==Sr)if(n=d(),n===Sr&&(n=Ur),n!==Sr)if(e.substr(_c,2)===Ia?(i=Ia,_c+=2):(i=Sr,0===xc&&c(qa)),i===Sr&&(e.substr(_c,2)===Da?(i=Da,_c+=2):(i=Sr,0===xc&&c(Ba))),i===Sr&&(i=Ur),i!==Sr){for(s=[],a=Mt(),a===Sr&&(a=Ot());a!==Sr;)s.push(a),a=Mt(),a===Sr&&(a=Ot());s!==Sr?(bc=t,r=Ga(r,i,s),t=r):(_c=t,t=xr)}else _c=t,t=xr;else _c=t,t=xr;else _c=t,t=xr;return t}function Dt(){var t,r,n,i,s,a;if(t=_c,e.substr(_c,4)===Gi?(r=Gi,_c+=4):(r=Sr,0===xc&&c(zi)),r!==Sr&&(bc=t,r=za()),t=r,t===Sr)if(t=_c,r=dr(),r!==Sr){for(n=[],i=_c,s=_(),s!==Sr?(a=dr(),a!==Sr?(s=[s,a],i=s):(_c=i,i=xr)):(_c=i,i=xr);i!==Sr;)n.push(i),i=_c,s=_(),s!==Sr?(a=dr(),a!==Sr?(s=[s,a],i=s):(_c=i,i=xr)):(_c=i,i=xr);n!==Sr?(bc=t,r=Ua(r,n),t=r):(_c=t,t=xr)}else _c=t,t=xr;return t}function Bt(){var e,t,r,n,i;return e=_c,t=Gt(),t!==Sr?(r=A(),r!==Sr?(n=Dt(),n===Sr&&(n=Ur),n!==Sr?(i=T(),i!==Sr?(bc=e,t=Qa(t,n),e=t):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr)):(_c=e,e=xr),e}function Gt(){var e,t;return e=_c,t=Ct(),t!==Sr&&(bc=e,t=Za(t)),e=t,e===Sr&&(e=kt()),e}function zt(){var t,r,n,i;return t=_c,e.substr(_c,2)===Ia?(r=Ia,_c+=2):(r=Sr,0===xc&&c(qa)),r===Sr&&(e.substr(_c,2)===Da?(r=Da,_c+=2):(r=Sr,0===xc&&c(Ba)),r===Sr&&(33===e.charCodeAt(_c)?(r=Wa,_c++):(r=Sr,0===xc&&c(Ha)),r===Sr&&(126===e.charCodeAt(_c)?(r=$a,_c++):(r=Sr,0===xc&&c(Xa)),r===Sr&&(43===e.charCodeAt(_c)?(r=Ja,_c++):(r=Sr,0===xc&&c(Ka)),r===Sr&&(45===e.charCodeAt(_c)?(r=Ya,_c++):(r=Sr,0===xc&&c(eo))))))),r===Sr&&(r=Ur),r!==Sr?(n=d(),n===Sr&&(n=Ur),n!==Sr?(i=qt(),i!==Sr?(bc=t,r=to(r,i),t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t}function Ut(){var t,r,n,i;return t=_c,42===e.charCodeAt(_c)?(r=ro,_c++):(r=Sr,0===xc&&c(no)),r===Sr&&(47===e.charCodeAt(_c)?(r=io,_c++):(r=Sr,0===xc&&c(so)),r===Sr&&(37===e.charCodeAt(_c)?(r=ao,_c++):(r=Sr,0===xc&&c(oo)))),r!==Sr?(n=_c,xc++,61===e.charCodeAt(_c)?(i=Yr,_c++):(i=Sr,0===xc&&c(en)),xc--,i===Sr?n=kr:(_c=n,n=xr),n!==Sr?(bc=t,r=co(r),t=r):(_c=t,t=xr)):(_c=t,t=xr),t}function Qt(){var e,t,r,n,i,s,a,o;if(e=_c,t=zt(),t!==Sr){for(r=[],n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=Ut(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=zt(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=Ut(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=zt(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(bc=e,t=uo(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function Zt(){var t,r,n,i;return t=_c,43===e.charCodeAt(_c)?(r=Ja,_c++):(r=Sr,0===xc&&c(Ka)),r!==Sr?(n=_c,xc++,43===e.charCodeAt(_c)?(i=Ja,_c++):(i=Sr,0===xc&&c(Ka)),i===Sr&&(61===e.charCodeAt(_c)?(i=Yr,_c++):(i=Sr,0===xc&&c(en))),xc--,i===Sr?n=kr:(_c=n,n=xr),n!==Sr?(bc=t,r=lo(),t=r):(_c=t,t=xr)):(_c=t,t=xr),t===Sr&&(t=_c,45===e.charCodeAt(_c)?(r=Ya,_c++):(r=Sr,0===xc&&c(eo)),r!==Sr?(n=_c,xc++,45===e.charCodeAt(_c)?(i=Ya,_c++):(i=Sr,0===xc&&c(eo)),i===Sr&&(61===e.charCodeAt(_c)?(i=Yr,_c++):(i=Sr,0===xc&&c(en))),xc--,i===Sr?n=kr:(_c=n,n=xr),n!==Sr?(bc=t,r=ho(),t=r):(_c=t,t=xr)):(_c=t,t=xr)),t}function Wt(){var e,t,r,n,i,s,a,o;if(e=_c,t=Qt(),t!==Sr){for(r=[],n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=Zt(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=Qt(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=Zt(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=Qt(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(bc=e,t=uo(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function Ht(){var t,r,n,i;return t=_c,e.substr(_c,2)===po?(r=po,_c+=2):(r=Sr,0===xc&&c(fo)),r===Sr&&(e.substr(_c,2)===vo?(r=vo,_c+=2):(r=Sr,0===xc&&c(mo))),r!==Sr?(n=_c,xc++,61===e.charCodeAt(_c)?(i=Yr,_c++):(i=Sr,0===xc&&c(en)),xc--,i===Sr?n=kr:(_c=n,n=xr),n!==Sr?(bc=t,r=co(r),t=r):(_c=t,t=xr)):(_c=t,t=xr),t}function $t(){var e,t,r,n,i,s,a,o;if(e=_c,t=Wt(),t!==Sr){for(r=[],n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=Ht(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=Wt(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=Ht(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=Wt(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(bc=e,t=uo(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function Xt(){var t,r,n,i;return t=_c,60===e.charCodeAt(_c)?(r=yo,_c++):(r=Sr,0===xc&&c(_o)),r!==Sr?(n=_c,xc++,60===e.charCodeAt(_c)?(i=yo,_c++):(i=Sr,0===xc&&c(_o)),xc--,i===Sr?n=kr:(_c=n,n=xr),n!==Sr?(61===e.charCodeAt(_c)?(i=Yr,_c++):(i=Sr,0===xc&&c(en)),i===Sr&&(i=Ur),i!==Sr?(bc=t,r=bo(i),t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t===Sr&&(t=_c,62===e.charCodeAt(_c)?(r=go,_c++):(r=Sr,0===xc&&c(So)),r!==Sr?(n=_c,xc++,62===e.charCodeAt(_c)?(i=go,_c++):(i=Sr,0===xc&&c(So)),xc--,i===Sr?n=kr:(_c=n,n=xr),n!==Sr?(61===e.charCodeAt(_c)?(i=Yr,_c++):(i=Sr,0===xc&&c(en)),i===Sr&&(i=Ur),i!==Sr?(bc=t,r=Ao(i),t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)),t}function Jt(){var e,t,r,n,i,s,a,o;if(e=_c,t=$t(),t!==Sr){for(r=[],n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=Xt(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=$t(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=Xt(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=$t(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(bc=e,t=uo(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function Kt(){var t,r;return t=_c,e.substr(_c,2)===To?(r=To,_c+=2):(r=Sr,0===xc&&c(xo)),r===Sr&&(e.substr(_c,2)===ko?(r=ko,_c+=2):(r=Sr,0===xc&&c(Co))),r!==Sr&&(bc=t,r=wo(r)),t=r}function Yt(){var e,t,r,n,i,s,a,o;if(e=_c,t=Jt(),t!==Sr){for(r=[],n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=Kt(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=Jt(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=Kt(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=Jt(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(bc=e,t=uo(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function er(){var t,r,n,i;return t=_c,38===e.charCodeAt(_c)?(r=Lo,_c++):(r=Sr,0===xc&&c(No)),r!==Sr?(n=_c,xc++,61===e.charCodeAt(_c)?(i=Yr,_c++):(i=Sr,0===xc&&c(en)),i===Sr&&(38===e.charCodeAt(_c)?(i=Lo,_c++):(i=Sr,0===xc&&c(No))),xc--,i===Sr?n=kr:(_c=n,n=xr),n!==Sr?(bc=t,r=Vo(),t=r):(_c=t,t=xr)):(_c=t,t=xr),t}function tr(){var e,t,r,n,i,s,a,o;if(e=_c,t=Yt(),t!==Sr){for(r=[],n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=er(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=Yt(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=er(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=Yt(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(bc=e,t=uo(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function rr(){var t,r,n,i;return t=_c,94===e.charCodeAt(_c)?(r=Eo,_c++):(r=Sr,0===xc&&c(Po)),r!==Sr?(n=_c,xc++,61===e.charCodeAt(_c)?(i=Yr,_c++):(i=Sr,0===xc&&c(en)),i===Sr&&(94===e.charCodeAt(_c)?(i=Eo,_c++):(i=Sr,0===xc&&c(Po))),xc--,i===Sr?n=kr:(_c=n,n=xr),n!==Sr?(bc=t,r=jo(),t=r):(_c=t,t=xr)):(_c=t,t=xr),t}function nr(){var e,t,r,n,i,s,a,o;if(e=_c,t=tr(),t!==Sr){for(r=[],n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=rr(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=tr(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=rr(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=tr(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(bc=e,t=uo(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function ir(){var t,r,n,i;return t=_c,124===e.charCodeAt(_c)?(r=Fo,_c++):(r=Sr,0===xc&&c(Ro)),r!==Sr?(n=_c,xc++,61===e.charCodeAt(_c)?(i=Yr,_c++):(i=Sr,0===xc&&c(en)),i===Sr&&(124===e.charCodeAt(_c)?(i=Fo,_c++):(i=Sr,0===xc&&c(Ro))),xc--,i===Sr?n=kr:(_c=n,n=xr),n!==Sr?(bc=t,r=Oo(),t=r):(_c=t,t=xr)):(_c=t,t=xr),t}function sr(){var e,t,r,n,i,s,a,o;if(e=_c,t=nr(),t!==Sr){for(r=[],n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=ir(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=nr(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=ir(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=nr(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(bc=e,t=uo(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function ar(){var t,r;return t=_c,e.substr(_c,2)===Mo?(r=Mo,_c+=2):(r=Sr,0===xc&&c(Io)),r!==Sr&&(bc=t,r=qo()),t=r}function or(){var e,t,r,n,i,s,a,o;if(e=_c,t=sr(),t!==Sr){for(r=[],n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=ar(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=sr(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=ar(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=sr(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(bc=e,t=uo(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function cr(){var t,r;return t=_c,e.substr(_c,2)===Do?(r=Do,_c+=2):(r=Sr,0===xc&&c(Bo)),r!==Sr&&(bc=t,r=Go()),t=r}function ur(){var e,t,r,n,i,s,a,o;if(e=_c,t=or(),t!==Sr){for(r=[],n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=cr(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=or(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=cr(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=or(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(bc=e,t=uo(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function lr(){var t,r;return t=_c,e.substr(_c,2)===zo?(r=zo,_c+=2):(r=Sr,0===xc&&c(Uo)),r!==Sr&&(bc=t,r=Qo()),t=r}function hr(){var e,t,r,n,i,s,a,o;if(e=_c,t=ur(),t!==Sr){for(r=[],n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=lr(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=ur(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);n!==Sr;)r.push(n),n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(s=lr(),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=ur(),o!==Sr?(i=[i,s,a,o],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr);r!==Sr?(bc=e,t=uo(t,r),e=t):(_c=e,e=xr)}else _c=e,e=xr;return e}function pr(){var t,r,n,i,s,a,o,u,l,h,p;return t=_c,r=hr(),r!==Sr?(n=_c,i=d(),i===Sr&&(i=Ur),i!==Sr?(63===e.charCodeAt(_c)?(s=Zo,_c++):(s=Sr,0===xc&&c(Wo)),s!==Sr?(a=d(),a===Sr&&(a=Ur),a!==Sr?(o=dr(),o!==Sr?(u=d(),u===Sr&&(u=Ur),u!==Sr?(58===e.charCodeAt(_c)?(l=Ho,_c++):(l=Sr,0===xc&&c($o)),l!==Sr?(h=d(),h===Sr&&(h=Ur),h!==Sr?(p=dr(),p!==Sr?(i=[i,s,a,o,u,l,h,p],n=i):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr)):(_c=n,n=xr),n===Sr&&(n=Ur),n!==Sr?(bc=t,r=Xo(r,n),t=r):(_c=t,t=xr)):(_c=t,t=xr),t}function dr(){var t,r,n,i,s,a;return t=_c,r=pr(),r!==Sr?(n=d(),n===Sr&&(n=Ur),n!==Sr?(61===e.charCodeAt(_c)?(i=Yr,_c++):(i=Sr,0===xc&&c(en)),i===Sr&&(e.substr(_c,2)===Jo?(i=Jo,_c+=2):(i=Sr,0===xc&&c(Ko)),i===Sr&&(e.substr(_c,2)===Yo?(i=Yo,_c+=2):(i=Sr,0===xc&&c(ec)),i===Sr&&(e.substr(_c,2)===tc?(i=tc,_c+=2):(i=Sr,0===xc&&c(rc)),i===Sr&&(e.substr(_c,2)===nc?(i=nc,_c+=2):(i=Sr,0===xc&&c(ic)),i===Sr&&(e.substr(_c,2)===sc?(i=sc,_c+=2):(i=Sr,0===xc&&c(ac)),i===Sr&&(e.substr(_c,3)===oc?(i=oc,_c+=3):(i=Sr,0===xc&&c(cc)),i===Sr&&(e.substr(_c,3)===uc?(i=uc,_c+=3):(i=Sr,0===xc&&c(lc)),i===Sr&&(e.substr(_c,2)===hc?(i=hc,_c+=2):(i=Sr,0===xc&&c(pc)),i===Sr&&(e.substr(_c,2)===dc?(i=dc,_c+=2):(i=Sr,0===xc&&c(fc)),i===Sr&&(e.substr(_c,2)===vc?(i=vc,_c+=2):(i=Sr,0===xc&&c(mc)))))))))))),i!==Sr?(s=d(),s===Sr&&(s=Ur),s!==Sr?(a=dr(),a!==Sr?(bc=t,r=yc(r,i,a),t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t===Sr&&(t=pr()),t}function fr(){var t,r,n,i,s,a,o,u;return t=_c,r=yt(),r!==Sr?(n=d(),n!==Sr?(i=Ct(),i!==Sr?(s=d(),s===Sr&&(s=Ur),s!==Sr?(61===e.charCodeAt(_c)?(a=Yr,_c++):(a=Sr,0===xc&&c(en)),a!==Sr?(o=d(),o===Sr&&(o=Ur),o!==Sr?(u=dr(),u!==Sr?(r=[r,n,i,s,a,o,u],t=r):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr)):(_c=t,t=xr),t===Sr&&(t=dr()),t}function vr(){return{line:s(),column:a(),offset:i(),span:n().length}}function mr(e){return new Lc(e.type,vr(),e)}function yr(e,t){for(var r=e,n=0;n<t.length;n++)r=new mr({type:"binary",operator:t[n][1],left:r,right:t[n][3]});return r}function _r(e,t,r){var n=t;r&&(n=n.concat([r]));var i=e[0];i.guarded_statements=e[1].statements;for(var s=i,a=0;a<n.length;a++)s.elseBody=n[a][0],s.elseBody.guarded_statements=n[a][1].statements,s=s.elseBody;return i}var br,gr=arguments.length>1?arguments[1]:{},Sr={},Ar={start:l},Tr=l,xr=Sr,kr=void 0,Cr=/^[\n]/,wr={type:"class",value:"[\\n]",description:"[\\n]"},Lr=function(){return"\n"},Nr={type:"any",description:"any character"},Vr={type:"other",description:"whitespace"},Er=/^[\\\n]/,Pr={type:"class",value:"[\\\\\\n]",description:"[\\\\\\n]"},jr=/^[\r\t\f\x0B ]/,Fr={type:"class",value:"[\\r\\t\\f\\x0B ]",description:"[\\r\\t\\f\\x0B ]"},Rr="/*",Or={type:"literal",value:"/*",description:'"/*"'},Mr="*/",Ir={type:"literal",value:"*/",description:'"*/"'},qr="//",Dr={type:"literal",value:"//",description:'"//"'},Br=/^[^\n]/,Gr={type:"class",value:"[^\\n]",description:"[^\\n]"},zr={type:"other",description:"comment"},Ur=null,Qr=";",Zr={type:"literal",value:";",description:'";"'},Wr=",",Hr={type:"literal",value:",",description:'","'},$r="[",Xr={type:"literal",value:"[",description:'"["'},Jr="]",Kr={type:"literal",value:"]",description:'"]"'},Yr="=",en={type:"literal",value:"=",description:'"="'},tn="(",rn={type:"literal",value:"(",description:'"("'},nn=")",sn={type:"literal",value:")",description:'")"'},an="{",on={type:"literal",value:"{",description:'"{"'},cn="}",un={type:"literal",value:"}",description:'"}"'},ln=function(e){for(var t=new mr({type:"root",statements:[]}),r=0;r<e.length;r++)e[r]&&(t.statements=t.statements.concat(e[r]));return t},hn=function(e){return e},pn=function(){return""},dn="#",fn={type:"literal",value:"#",description:'"#"'},vn="undef",mn={type:"literal",value:"undef",description:'"undef"'},yn="pragma",_n={type:"literal",value:"pragma",description:'"pragma"'},bn="version",gn={type:"literal",value:"version",description:'"version"'},Sn="error",An={type:"literal",value:"error",description:'"error"'},Tn="extension",xn={type:"literal",value:"extension",description:'"extension"'},kn="line",Cn={type:"literal",value:"line",description:'"line"'},wn=function(e){return e.join("")},Ln=function(e,t){return new mr({type:"preprocessor",directive:"#"+e,value:t})},Nn=/^[A-Za-z_]/,Vn={type:"class",value:"[A-Za-z_]",description:"[A-Za-z_]"},En=/^[A-Za-z_0-9]/,Pn={type:"class",value:"[A-Za-z_0-9]",description:"[A-Za-z_0-9]"},jn=function(e,t){return new mr({type:"identifier",name:e+t.join("")})},Fn=function(e,t){return e?[e].concat(t.map(function(e){return e[1]})):[]},Rn=function(e,t){var r=new mr({type:"macro_call",macro_name:e,parameters:t});return t||(r.parameters=[]),r},On="define",Mn={type:"literal",value:"define",description:'"define"'},In=/^[ \t]/,qn={type:"class",value:"[ \\t]",description:"[ \\t]"},Dn=function(e,t,r){return new mr({type:"preprocessor",directive:"#define",identifier:e.name,token_string:r,parameters:t||null})},Bn="ifdef",Gn={type:"literal",value:"ifdef",description:'"ifdef"'},zn="ifndef",Un={type:"literal",value:"ifndef",description:'"ifndef"'},Qn="if",Zn={type:"literal",value:"if",description:'"if"'},Wn=function(e,t){return new mr({type:"preprocessor",directive:"#"+e,value:t})},Hn="elif",$n={type:"literal",value:"elif",description:'"elif"'},Xn=function(e){return new mr({type:"preprocessor",directive:"#elif",value:e})},Jn="else",Kn={type:"literal",value:"else",description:'"else"'},Yn=function(){return new mr({type:"preprocessor",directive:"#else"})},ei="endif",ti={type:"literal",value:"endif",description:'"endif"'},ri=function(e,t,r){return _r(e,t,r)},ni=function(e,t){return result=new mr({type:"function_declaration",name:e.name,returnType:e.returnType,parameters:e.parameters,body:t})},ii=function(e){return result=new mr({type:"scope",statements:[]}),e&&e.statements&&(result.statements=e.statements),result},si=function(e){return{statements:e}},ai=function(e){return e},oi=function(e,t,r){return result=new mr({type:"if_statement",condition:e,body:t}),r&&(result.elseBody=r[2]),result},ci="for",ui={type:"literal",value:"for",description:'"for"'},li=function(e,t,r,n){return new mr({type:"for_statement",initializer:e,condition:t,increment:r,body:n})},hi="while",pi={type:"literal",value:"while",description:'"while"'},di=function(e){return{condition:e}},fi=function(e,t){return new mr({type:"while_statement",condition:e.condition,body:t})},vi="do",mi={type:"literal",value:"do",description:'"do"'},yi=function(e,t){return new mr({type:"do_statement",condition:t.condition,body:e})},_i="return",bi={type:"literal",value:"return",description:'"return"'},gi=function(e){return new mr({type:"return",value:e})},Si="continue",Ai={type:"literal",value:"continue",description:'"continue"'},Ti="break",xi={type:"literal",value:"break",description:'"break"'},ki=function(){return"fs"==wc},Ci="discard",wi={type:"literal",value:"discard",description:'"discard"'},Li=function(){return"discard"},Ni=function(e){return new mr({type:e[0]})},Vi=function(e){return new mr({type:"expression",expression:e})},Ei={type:"other",description:"declaration"},Pi=function(e){return e},ji=function(e,t){return new mr({type:"declarator",typeAttribute:e,declarators:t})},Fi=function(){return"vs"==wc},Ri="invariant",Oi={type:"literal",value:"invariant",description:'"invariant"'},Mi=function(e,t){var r=[e].concat(t.map(function(e){return e[1]}));return new mr({type:"invariant",identifiers:r})},Ii="precision",qi={type:"literal",value:"precision",description:'"precision"'},Di=function(e,t){return new mr({type:"precision",precision:e,typeName:t})},Bi=function(e,t){return new mr({type:"declarator",typeAttribute:e,declarators:t})},Gi="void",zi={type:"literal",value:"void",description:'"void"'},Ui=function(e,t){return[e].concat(t.map(function(e){return e[1]}))},Qi=function(e,t,r){return result=new mr({type:"function_prototype",name:t.name,returnType:e,parameters:r}),"void"!=r&&r||(result.parameters=[]),result},Zi="inout",Wi={type:"literal",value:"inout",description:'"inout"'},Hi="in",$i={type:"literal",value:"in",description:'"in"'},Xi="out",Ji={type:"literal",value:"out",description:'"out"'},Ki=function(e,t,r,n,i,s){var a=new mr({type:"parameter",type_name:n,name:i.name});return e&&(a.typeQualifier=e[0]),t&&(a.parameterQualifier=t[0]),r&&(a.precision=r[0]),s&&(a.arraySize=s[1]),a.typeQualifier&&a.parameterQualifier&&"in"!=a.parameterQualifier?null:a},Yi=function(e,t){return[e].concat(t.map(function(e){return e[1]}))},es=function(e){return new mr({type:"declarator_item",name:e})},ts=function(e,t){return new mr({type:"declarator_item",name:e,arraySize:t,isArray:!0})},rs=function(e){return new mr({type:"declarator_item",name:e,isArray:!0})},ns=function(e,t){return new mr({type:"declarator_item",name:e,initializer:t})},is=function(e){return e.map(function(e){return new mr({type:"declarator",typeAttribute:e[0],declarators:e[2]})})},ss="struct",as={type:"literal",value:"struct",description:'"struct"'},os=function(e,t,r,n){var i=new mr({type:"struct_definition",members:r});return e&&(i.qualifier=e[0]),t&&(i.name=t[1].name,kc[i.name]=i),n&&(i.declarators=n),i},cs=function(e,t){var r=new mr({type:"type",name:t});return e&&(r.precision=e[0]),r},us={type:"other",description:"locally specified type"},ls=function(e,t){var r=t;return e&&(r.qualifier=e[0]),r},hs="attribute",ps={type:"literal",value:"attribute",description:'"attribute"'},ds=function(){return"attribute"},fs=function(e,t){var r=t;return r.qualifier=e,r},vs={type:"other",description:"fully specified type"},ms={type:"other",description:"precision qualifier"},ys="highp",_s={type:"literal",value:"highp",description:'"highp"'},bs="mediump",gs={type:"literal",value:"mediump",description:'"mediump"'},Ss="lowp",As={type:"literal",value:"lowp",description:'"lowp"'},Ts="const",xs={type:"literal",value:"const",description:'"const"'},ks={type:"other",description:"type qualifier"},Cs="varying",ws={type:"literal",value:"varying",description:'"varying"'},Ls=function(){return"invariant varying"},Ns="uniform",Vs={type:"literal",value:"uniform",description:'"uniform"'},Es={type:"other",description:"void"},Ps=function(){return new mr({type:"type",name:"void"})},js={type:"other",description:"type name"},Fs="float",Rs={type:"literal",value:"float",description:'"float"'},Os="int",Ms={type:"literal",value:"int",description:'"int"'},Is="bool",qs={type:"literal",value:"bool",description:'"bool"'},Ds="sampler2D",Bs={type:"literal",value:"sampler2D",description:'"sampler2D"'},Gs="samplerCube",zs={type:"literal",value:"samplerCube",description:'"samplerCube"'},Us=function(e){return e.name in kc?e.name:null},Qs={type:"other",description:"identifier"},Zs=/^[^A-Za-z_0-9]/,Ws={type:"class",value:"[^A-Za-z_0-9]",description:"[^A-Za-z_0-9]"},Hs={type:"other",description:"keyword"},$s="true",Xs={type:"literal",value:"true",description:'"true"'},Js="false",Ks={type:"literal",value:"false",description:'"false"'},Ys=/^[bi]/,ea={type:"class",value:"[bi]",description:"[bi]"},ta="vec",ra={type:"literal",value:"vec",description:'"vec"'},na=/^[234]/,ia={type:"class",value:"[234]",description:"[234]"},sa=function(e){return e.join("")},aa="mat",oa={type:"literal",value:"mat",description:'"mat"'},ca=/^[1-9]/,ua={type:"class",value:"[1-9]",description:"[1-9]"},la=/^[0-9]/,ha={type:"class",value:"[0-9]",description:"[0-9]"},pa=function(e,t){return new mr({type:"int",value:parseInt([e].concat(t).join(""),10)})},da="0",fa={type:"literal",value:"0",description:'"0"'},va=/^[Xx]/,ma={type:"class",value:"[Xx]",description:"[Xx]"},ya=/^[0-9A-Fa-f]/,_a={type:"class",value:"[0-9A-Fa-f]",description:"[0-9A-Fa-f]"},ba=function(e){return new mr({type:"int",value:parseInt(e.join(""),16)})},ga=/^[0-7]/,Sa={type:"class",value:"[0-7]",description:"[0-7]"},Aa=function(e){return new mr({type:"int",value:parseInt(e.join(""),8)})},Ta=function(){return new mr({type:"int",value:0})},xa=".",ka={type:"literal",value:".",description:'"."'},Ca=function(e){return e[0]=e[0].join(""),e[2]=e[2].join(""),new mr({type:"float",value:parseFloat(e.join(""))})},wa=function(e){return new mr({type:"float",value:parseFloat(e[0].join("")+e[1])})},La=/^[Ee]/,Na={type:"class",value:"[Ee]",description:"[Ee]"},Va=/^[+\-]/,Ea={type:"class",value:"[+\\-]",description:"[+\\-]"},Pa=function(e,t){return["e",e].concat(t).join("")},ja=function(e){return e},Fa=function(e){return new mr({type:"bool",value:"true"==e})},Ra=function(e){return new mr({type:"accessor",index:e})
},Oa=function(e){return new mr({type:"field_selector",selection:e.name})},Ma=function(e,t){for(var r=e,n=0;n<t.length;n++)r=new mr({type:"postfix",operator:t[n],expression:r});return r},Ia="++",qa={type:"literal",value:"++",description:'"++"'},Da="--",Ba={type:"literal",value:"--",description:'"--"'},Ga=function(e,t,r){var n=e;t&&(n=new mr({type:"postfix",operator:new mr({id:Cc++,type:"operator",operator:t}),expression:n}));for(var i=0;i<r.length;i++)n=new mr({type:"postfix",operator:r[i],expression:n});return n},za=function(){return[]},Ua=function(e,t){return[e].concat(t.map(function(e){return e[1]}))},Qa=function(e,t){var r=new mr({type:"function_call",function_name:e,parameters:t});return t||(r.parameters=[]),r},Za=function(e){return e.name},Wa="!",Ha={type:"literal",value:"!",description:'"!"'},$a="~",Xa={type:"literal",value:"~",description:'"~"'},Ja="+",Ka={type:"literal",value:"+",description:'"+"'},Ya="-",eo={type:"literal",value:"-",description:'"-"'},to=function(e,t){return result=t,e&&(result=new mr({type:"unary",expression:result,operator:new mr({type:"operator",operator:e})})),result},ro="*",no={type:"literal",value:"*",description:'"*"'},io="/",so={type:"literal",value:"/",description:'"/"'},ao="%",oo={type:"literal",value:"%",description:'"%"'},co=function(e){return new mr({type:"operator",operator:e})},uo=function(e,t){return yr(e,t)},lo=function(){return new mr({type:"operator",operator:"+"})},ho=function(){return new mr({type:"operator",operator:"-"})},po="<<",fo={type:"literal",value:"<<",description:'"<<"'},vo=">>",mo={type:"literal",value:">>",description:'">>"'},yo="<",_o={type:"literal",value:"<",description:'"<"'},bo=function(e){return new mr({type:"operator",operator:"<"+(e||"")})},go=">",So={type:"literal",value:">",description:'">"'},Ao=function(e){return new mr({type:"operator",operator:">"+(e||"")})},To="==",xo={type:"literal",value:"==",description:'"=="'},ko="!=",Co={type:"literal",value:"!=",description:'"!="'},wo=function(e){return new mr({type:"operator",operator:e})},Lo="&",No={type:"literal",value:"&",description:'"&"'},Vo=function(){return new mr({type:"operator",operator:"&"})},Eo="^",Po={type:"literal",value:"^",description:'"^"'},jo=function(){return new mr({type:"operator",operator:"^"})},Fo="|",Ro={type:"literal",value:"|",description:'"|"'},Oo=function(){return new mr({type:"operator",operator:"|"})},Mo="&&",Io={type:"literal",value:"&&",description:'"&&"'},qo=function(){return new mr({type:"operator",operator:"&&"})},Do="^^",Bo={type:"literal",value:"^^",description:'"^^"'},Go=function(){return new mr({type:"operator",operator:"^^"})},zo="||",Uo={type:"literal",value:"||",description:'"||"'},Qo=function(){return new mr({type:"operator",operator:"||"})},Zo="?",Wo={type:"literal",value:"?",description:'"?"'},Ho=":",$o={type:"literal",value:":",description:'":"'},Xo=function(e,t){return result=e,t&&(result=new mr({type:"ternary",condition:e,is_true:t[3],is_false:t[7]})),result},Jo="*=",Ko={type:"literal",value:"*=",description:'"*="'},Yo="/=",ec={type:"literal",value:"/=",description:'"/="'},tc="%=",rc={type:"literal",value:"%=",description:'"%="'},nc="+=",ic={type:"literal",value:"+=",description:'"+="'},sc="-=",ac={type:"literal",value:"-=",description:'"-="'},oc="<<=",cc={type:"literal",value:"<<=",description:'"<<="'},uc=">>=",lc={type:"literal",value:">>=",description:'">>="'},hc="&=",pc={type:"literal",value:"&=",description:'"&="'},dc="^=",fc={type:"literal",value:"^=",description:'"^="'},vc="|=",mc={type:"literal",value:"|=",description:'"|="'},yc=function(e,t,r){return new mr({type:"binary",operator:new mr({type:"operator",operator:t}),left:e,right:r})},_c=0,bc=0,gc=0,Sc={line:1,column:1,seenCR:!1},Ac=0,Tc=[],xc=0;if("startRule"in gr){if(!(gr.startRule in Ar))throw new Error("Can't start parsing from rule \""+gr.startRule+'".');Tr=Ar[gr.startRule]}var kc={},Cc=0,wc="vs",Lc=t("./ast");if(br=Tr(),br!==Sr&&_c===e.length)return br;throw br!==Sr&&_c<e.length&&c({type:"end",description:"end of input"}),u(null,Tc,Ac)}return e(r,Error),{SyntaxError:r,parse:n}}()}),e.define("compiler/shader",function(e,t){var r={};r.Error=t("../error"),r.Object=t("../events").Object,r.ASTNode=t("./ast"),r.ASTVisitor=t("./visitor"),r.Parser=t("./parser"),r.Typechecker=t("./typecheck"),r.CodeGenerator=t("./codegen"),r.Shader=function(e,t){r.Object.call(this),this.sourceText=e;try{this.ast=r.Parser.parse(e)}catch(n){throw t===r.Shader.Type.Vertex&&(n.type=r.Error.Type.VertexShaderParsing),t===r.Shader.Type.Fragment&&(n.type=r.Error.Type.FragmentShaderParsing),n}this.type=t,this._typecheckResult=null,this._executable=null,this._shouldEmitDebuggerStatement=!1,console.assert(t===r.Shader.Type.Vertex||t===r.Shader.Type.Fragment),this._uniforms=[],this._varyings=[],this._attributes=[],this._errors=[],this._extractVariables()},r.Object.addConstructorFunctions(r.Shader),r.Shader.Event={ExecutableChanged:"shader-executable-changed"},r.Shader.Type={Vertex:"shader-type-vertex",Fragment:"shader-type-fragment"},r.Shader.prototype={constructor:r.Shader,__proto__:r.Object.prototype,get uniforms(){return this._uniforms.slice()},get attributes(){return this._attributes.slice()},get varyings(){return this._varyings.slice()},get executable(){return this._executable||(this._executable=new r.CodeGenerator(this).translateShader()),this._executable},get shouldEmitDebuggerStatement(){return this._shouldEmitDebuggerStatement},set shouldEmitDebuggerStatement(e){this._shouldEmitDebuggerStatement!==e&&(this._shouldEmitDebuggerStatement=e,this._clearExecutable())},typecheck:function(){return null!==this._typecheckResult?this._typecheckResult:(this._typecheckResult=new r.Typechecker(this).typecheck(),this._typecheckResult)},_extractVariables:function(){var e=new VariableExtractor;if(e.extract(this),e.errors.length){this._errors=this._errors.concat(e.errors);for(var t=0;t<this._errors.length;++t)console.error("Error extracting variables: "+JSON.stringify(this._errors[t]));throw new Error(this._errors[0].message)}this._uniforms=this._uniforms.concat(e.uniforms),this._attributes=this._attributes.concat(e.attributes),this._varyings=this._varyings.concat(e.varyings)},_clearExecutable:function(){this._executable=null,this.dispatchEventToListeners(r.Shader.Event.ExecutableChanged)}},VariableExtractor=function(){r.ASTVisitor.call(this,VariableExtractor.Functions),this.uniforms=[],this.attributes=[],this.varyings=[],this.errors=[]},VariableExtractor.prototype={__proto__:r.ASTVisitor.prototype,constructor:VariableExtractor,extract:function(e){this.shader=e,this.visitNode(e.ast),this.shader.type===r.Shader.Type.Vertex&&(this.varyings.push({name:"gl_Position",type:"vec4",qualifier:"varying",usage:"out",builtin:!0}),this.varyings.push({name:"gl_PointSize",type:"float",qualifier:"varying",usage:"out",builtin:!0})),this.shader.type===r.Shader.Type.Fragment&&(this.varyings.push({name:"gl_FragCoord",type:"vec4",qualifier:"varying",usage:"in",builtin:!0}),this.varyings.push({name:"gl_FrontFacing",type:"bool",qualifier:"varying",usage:"in",builtin:!0}),this.varyings.push({name:"gl_PointCoord",type:"vec2",qualifier:"varying",usage:"in",builtin:!0}),this.varyings.push({name:"gl_FragColor",type:"vec4",qualifier:"varying",usage:"out",builtin:!0}),this.varyings.push({name:"gl_FragData",type:"vec4[]",qualifier:"varying",usage:"out",builtin:!0})),this.shader=null},defaultVisitor:function(){}},VariableExtractor.Functions={},VariableExtractor.Functions[r.ASTNode.Types.Program]=function(e){this.visitList(e.statements)},VariableExtractor.Functions[r.ASTNode.Types.DeclaratorItem]=function(e){return this.visitNode(e.name)},VariableExtractor.Functions[r.ASTNode.Types.Identifier]=function(e){return e.name},VariableExtractor.Functions[r.ASTNode.Types.Declarator]=function(e){var t=e.typeAttribute,n=this.visitList(e.declarators);if(this.shader.type===r.Shader.Type.Fragment&&"attribute"===t.qualifier)return void this.errors.push({node:e,message:"'attribute' variable not allowed in fragment shader."});var i=null;"varying"===t.qualifier&&(i=this.varyings),"uniform"===t.qualifier&&(i=this.uniforms),"attribute"===t.qualifier&&(i=this.attributes);var s=!0;this.shader.type===r.Shader.Type.Vertex&&"varying"===t.qualifier&&(s=!1),this.shader.type===r.Shader.Type.Fragment&&"gl_FragColor"==t.name&&(s=!1);for(var a=0;a<n.length;++a)i.push({type:t.name,name:n[a],qualifier:t.qualifier,usage:s?"in":"out"})},e.exports=r.Shader}),e.define("compiler/program",function(e,t){var r={};r.Runtime=t("../runtime");var n={};n.Shader=t("./shader"),n.Typechecker=t("./typecheck"),n.Error=t("../error"),n.Object=t("../events").Object,n.Builtins=t("../runtime/builtins"),n.Environment=t("../runtime/environment"),n.Program=function(){n.Object.call(this),this.vertexShader=null,this.fragmentShader=null,this._linkerResult=null,this._programCode=null},n.Program.Event={ShaderChanged:"program-shader-changed",Error:"program-error"},n.Program.prototype={constructor:n.Program,__proto__:n.Object.prototype,shaderWithType:function(e){return e===n.Shader.Type.Vertex?this.vertexShader:e===n.Shader.Type.Fragment?this.fragmentShader:void console.error("Unknown shader type requested: ",e)},updateShaderWithType:function(e,t){this._linkerResult=!1,this._programCode=null;try{var r=this.shaderWithType(e),i=new n.Shader(t,e)}catch(s){var a=null;return e===n.Shader.Type.Vertex&&(a=n.Error.Type.VertexShaderParsing),e===n.Shader.Type.Fragment&&(a=n.Error.Type.FragmentShaderParsing),void this.dispatchEventToListeners(n.Program.Event.Error,{type:a,message:s.message})}e===n.Shader.Type.Fragment?this.fragmentShader=i:e===n.Shader.Type.Vertex&&(this.vertexShader=i),this.dispatchEventToListeners(n.Program.Event.ShaderChanged,{oldShader:r,newShader:i})},renderToBuffer:function(e,t){if(!this.vertexShader)throw new Error("Couldn't run shader program: no vertex shader specified.");if(!this.vertexShader.typecheck())throw new Error("Couldn't run shader program: typechecking failed for vertex shader program.");if(!this.fragmentShader)throw new Error("Couldn't run shader program: no fragment shader specified.");if(!this.fragmentShader.typecheck())throw new Error("Couldn't run shader program: typechecking failed for fragment shader program.");if(this._linkerResult||(this._linkerResult=this._linkShaders()),!this._linkerResult)throw new Error("Couldn't run shader program: linking failed.");if(!e.validateForShader(this.vertexShader))throw new Error("Couldn't run shader program: vertex shader environment validation failed.");if(!e.validateForShader(this.fragmentShader))throw new Error("Couldn't run shader program: vertex shader environment validation failed.");try{e.enterRunScope();for(var i=0;i<t.height;++i){e.get("gl_FragCoord").set("y",i);for(var s=0;s<t.width;++s){e.get("gl_FragCoord").set("x",s),this.fragmentShader.executable.code.call(null,r,e);var a=e.get("gl_FragColor");a=n.Builtins.clamp(a,0,1),t.data[4*(t.width*i+s)+0]=255*a.d[0],t.data[4*(t.width*i+s)+1]=255*a.d[1],t.data[4*(t.width*i+s)+2]=255*a.d[2],t.data[4*(t.width*i+s)+3]=255*a.d[3]}}e.exitRunScope()}catch(o){e.exitRunScope()}},runShaderWithType:function(e,t){var r=this.shaderWithType(e);r&&this._runSingleShader(r,t)},runShaders:function(e){(this.vertexShader||this.fragmentShader)&&(this.fragmentShader&&this._runSingleShader(this.fragmentShader,e),this.vertexShader&&this._runSingleShader(this.vertexShader,e))},_runSingleShader:function(e,t){if(console.assert(e instanceof n.Shader,e),console.assert(t instanceof n.Environment,t),!e)throw new Error("Couldn't run single shader: the shader was empty.");if(!e.typecheck())throw new Error("Couldn't run single shader: typechecking failed.");if(!t.validateForShader(e))throw new Error("Couldn't run single shader: environment validation failed.");if(e.executable.error){var i=e.type===n.Shader.Type.Vertex?n.Error.Type.VertexShaderTranslation:n.Error.Type.FragmentShaderTranslation,s={type:i,message:e.executable.error};return void this.dispatchEventToListeners(n.Program.Event.Error,s)}t.enterRunScope();try{e.executable.code.call(null,r,t)}catch(a){var i=e.type===n.Shader.Type.Vertex?n.Error.Type.VertexShaderExecution:n.Error.Type.FragmentShaderExecution;return t.exitRunScope(),void this.dispatchEventToListeners(n.Program.Event.Error,{type:i,message:a.message})}t.exitRunScope()},_linkShaders:function(){return!0}},e.exports=n.Program}),e.define("glsl",function(e,t){var r={VERSION:"0.1.0",Parser:t("./compiler/parser"),PrettyPrinter:t("./compiler/pretty"),Shader:t("./compiler/shader"),Program:t("./compiler/program"),Runtime:t("./runtime"),Environment:t("./runtime/environment"),Object:t("./events").Object,Event:t("./events").Event,Error:t("./error")};e.exports=r}),e.glsl}();